import{aa as k,a as r,j as e,B as a,A as t,Q as l,ab as E}from"./index-CJhurDKw.js";import{T as d}from"./TextField-Gt7KocES.js";import{D,a as L,b as W}from"./DialogTitle-XUSj7cbv.js";import{D as P}from"./DialogActions-AHNQi9TV.js";const R=({setIsLoggedIn:j})=>{const b=k(),[c,v]=r.useState(""),[g,y]=r.useState(""),[h,u]=r.useState(""),[w,n]=r.useState(!1),[m,C]=r.useState(""),[x,p]=r.useState(""),[f,i]=r.useState(""),F=async o=>{o.preventDefault(),u("");try{await E({username:c,password:g}),sessionStorage.setItem("isLoggedIn","true"),j(!0),b("/dashboard"),setTimeout(()=>window.location.reload(),100)}catch(s){u(s||"Login failed")}},S=async()=>{i(""),p("");try{const o=await fetch("/api/forgot-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:m})}),s=await o.json();o.ok?p(s.message||"Reset link sent."):i(s.error||"Something went wrong.")}catch{i("Network error. Try again later.")}};return e.jsxs(a,{sx:{height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#5D378C",p:2,position:"relative"},children:[e.jsxs(a,{sx:{display:{xs:"none",md:"block"},position:"absolute",top:"5%",left:"5%",color:"white",zIndex:0},children:[e.jsx(t,{variant:"h2",color:"#FF7704",fontWeight:600,children:"Welcome"}),e.jsx(t,{variant:"h4",fontWeight:600,children:"Cauayan Cares - Archiving System"}),e.jsx(t,{variant:"h6",children:"Preserving Records, Empowering Communities"})]}),e.jsx(a,{sx:{display:{xs:"none",md:"block"},position:"absolute",bottom:"10%",left:"5%",zIndex:0},children:e.jsx("img",{src:"/LoginPoster.svg",alt:"Login Poster",style:{maxWidth:"100%",height:"auto"}})}),e.jsxs(a,{sx:{background:"#FBEAFF",p:4,borderRadius:"10px",width:{xs:"90%",sm:"60%",md:"30%"},minWidth:"300px",boxShadow:3,position:{xs:"relative",md:"absolute"},right:{md:"10%"}},children:[e.jsx(t,{variant:"h5",fontWeight:"bold",color:"#FF7706",gutterBottom:!0,children:"Login"}),e.jsx(t,{color:"textSecondary",mb:2,children:"Please enter your login credentials"}),h&&e.jsx(t,{color:"error",mb:2,children:h}),e.jsxs("form",{onSubmit:F,children:[e.jsx(d,{fullWidth:!0,type:"text",label:"Username",value:c,onChange:o=>v(o.target.value),required:!0,variant:"outlined",margin:"normal"}),e.jsx(d,{fullWidth:!0,type:"password",label:"Password",value:g,onChange:o=>y(o.target.value),required:!0,variant:"outlined",margin:"normal"}),e.jsx(l,{type:"submit",variant:"contained",fullWidth:!0,sx:{mt:2,bgcolor:"#5D378C",color:"#fff",":hover":{bgcolor:"#4B2A6F"}},children:"Login"})]}),e.jsx(t,{variant:"body2",sx:{mt:2,textAlign:"center",cursor:"pointer",color:"#5D378C"},onClick:()=>n(!0),children:"Forgot your password?"})]}),e.jsxs(D,{open:w,onClose:()=>n(!1),children:[e.jsx(L,{children:"Forgot Password"}),e.jsxs(W,{children:[e.jsx(t,{mb:2,children:"Enter your registered email address to receive a password reset link."}),f&&e.jsx(t,{color:"error",mb:2,children:f}),x&&e.jsx(t,{color:"primary",mb:2,children:x}),e.jsx(d,{autoFocus:!0,margin:"dense",label:"Email Address",type:"email",fullWidth:!0,variant:"outlined",value:m,onChange:o=>C(o.target.value)})]}),e.jsxs(P,{children:[e.jsx(l,{onClick:()=>n(!1),children:"Cancel"}),e.jsx(l,{variant:"contained",sx:{bgcolor:"#5D378C",":hover":{bgcolor:"#4B2A6F"}},onClick:S,children:"Send Reset Link"})]})]})]})};export{R as default};
