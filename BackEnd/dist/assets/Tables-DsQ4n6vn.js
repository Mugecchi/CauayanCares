import{q as vt,k as St,a as r,s as wt,A as Ct,H as _t,Q as ye,C as Pt,z as Tt,R as Je,D as Rt,S as Ot,j as e,b as He,U as be,t as Ee,V as Dt,W as tt,i as Mt,v as Ie,w as at,X as Ve,Y as P,K as J,Z as At,$ as Et,a0 as It,a1 as he,a2 as qe,a3 as kt,a4 as Lt,a5 as Ke,a6 as Nt,a7 as Ft,a8 as Ye,a9 as Wt,aa as $t,ab as Xe,ac as Bt,ad as Gt,ae as Ze,af as zt,ag as Qt,ah as Ut,ai as Jt,aj as X}from"./index-Bfq1WVLN.js";import{T as Z,C as Ht}from"./TablePagination-Cau-V-Oh.js";import{G as Vt,T as j,F as qt,I as Kt,S as Yt}from"./TextField-CtzlrLrV.js";import{M as H}from"./MenuItem-sJEcDE2M.js";import{T as ee,a as te,b as ae,c as E,d as s,e as ne}from"./TableRow-CZwIbitv.js";import{P as nt}from"./Popper-Cx6g3C4f.js";import{I as ve}from"./IconButton-Hjxu0P5D.js";import{S as se,A as re}from"./Snackbar-CqUCZwf7.js";import{D as q,a as K,b as Y}from"./DialogTitle-DimfTvsB.js";import{D as ie}from"./DialogActions-BdMMlxkI.js";function Xt(l){return St("MuiTooltip",l)}const R=vt("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]);function Zt(l){return Math.round(l*1e5)/1e5}const ea=l=>{const{classes:i,disableInteractive:g,arrow:v,touch:d,placement:S}=l,y={popper:["popper",!g&&"popperInteractive",v&&"popperArrow"],tooltip:["tooltip",v&&"tooltipArrow",d&&"touch",`tooltipPlacement${tt(S.split("-")[0])}`],arrow:["arrow"]};return Mt(y,Xt,i)},ta=Ee(nt,{name:"MuiTooltip",slot:"Popper",overridesResolver:(l,i)=>{const{ownerState:g}=l;return[i.popper,!g.disableInteractive&&i.popperInteractive,g.arrow&&i.popperArrow,!g.open&&i.popperClose]}})(Ie(({theme:l})=>({zIndex:(l.vars||l).zIndex.tooltip,pointerEvents:"none",variants:[{props:({ownerState:i})=>!i.disableInteractive,style:{pointerEvents:"auto"}},{props:({open:i})=>!i,style:{pointerEvents:"none"}},{props:({ownerState:i})=>i.arrow,style:{[`&[data-popper-placement*="bottom"] .${R.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${R.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${R.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}},[`&[data-popper-placement*="left"] .${R.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}}}},{props:({ownerState:i})=>i.arrow&&!i.isRtl,style:{[`&[data-popper-placement*="right"] .${R.arrow}`]:{left:0,marginLeft:"-0.71em"}}},{props:({ownerState:i})=>i.arrow&&!!i.isRtl,style:{[`&[data-popper-placement*="right"] .${R.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:i})=>i.arrow&&!i.isRtl,style:{[`&[data-popper-placement*="left"] .${R.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:i})=>i.arrow&&!!i.isRtl,style:{[`&[data-popper-placement*="left"] .${R.arrow}`]:{left:0,marginLeft:"-0.71em"}}}]}))),aa=Ee("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(l,i)=>{const{ownerState:g}=l;return[i.tooltip,g.touch&&i.touch,g.arrow&&i.tooltipArrow,i[`tooltipPlacement${tt(g.placement.split("-")[0])}`]]}})(Ie(({theme:l})=>({backgroundColor:l.vars?l.vars.palette.Tooltip.bg:at(l.palette.grey[700],.92),borderRadius:(l.vars||l).shape.borderRadius,color:(l.vars||l).palette.common.white,fontFamily:l.typography.fontFamily,padding:"4px 8px",fontSize:l.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:l.typography.fontWeightMedium,[`.${R.popper}[data-popper-placement*="left"] &`]:{transformOrigin:"right center"},[`.${R.popper}[data-popper-placement*="right"] &`]:{transformOrigin:"left center"},[`.${R.popper}[data-popper-placement*="top"] &`]:{transformOrigin:"center bottom",marginBottom:"14px"},[`.${R.popper}[data-popper-placement*="bottom"] &`]:{transformOrigin:"center top",marginTop:"14px"},variants:[{props:({ownerState:i})=>i.arrow,style:{position:"relative",margin:0}},{props:({ownerState:i})=>i.touch,style:{padding:"8px 16px",fontSize:l.typography.pxToRem(14),lineHeight:`${Zt(16/14)}em`,fontWeight:l.typography.fontWeightRegular}},{props:({ownerState:i})=>!i.isRtl,style:{[`.${R.popper}[data-popper-placement*="left"] &`]:{marginRight:"14px"},[`.${R.popper}[data-popper-placement*="right"] &`]:{marginLeft:"14px"}}},{props:({ownerState:i})=>!i.isRtl&&i.touch,style:{[`.${R.popper}[data-popper-placement*="left"] &`]:{marginRight:"24px"},[`.${R.popper}[data-popper-placement*="right"] &`]:{marginLeft:"24px"}}},{props:({ownerState:i})=>!!i.isRtl,style:{[`.${R.popper}[data-popper-placement*="left"] &`]:{marginLeft:"14px"},[`.${R.popper}[data-popper-placement*="right"] &`]:{marginRight:"14px"}}},{props:({ownerState:i})=>!!i.isRtl&&i.touch,style:{[`.${R.popper}[data-popper-placement*="left"] &`]:{marginLeft:"24px"},[`.${R.popper}[data-popper-placement*="right"] &`]:{marginRight:"24px"}}},{props:({ownerState:i})=>i.touch,style:{[`.${R.popper}[data-popper-placement*="top"] &`]:{marginBottom:"24px"}}},{props:({ownerState:i})=>i.touch,style:{[`.${R.popper}[data-popper-placement*="bottom"] &`]:{marginTop:"24px"}}}]}))),na=Ee("span",{name:"MuiTooltip",slot:"Arrow",overridesResolver:(l,i)=>i.arrow})(Ie(({theme:l})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:l.vars?l.vars.palette.Tooltip.bg:at(l.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}})));let Se=!1;const et=new Dt;let ue={x:0,y:0};function we(l,i){return(g,...v)=>{i&&i(g,...v),l(g,...v)}}const Ae=r.forwardRef(function(i,g){const v=wt({props:i,name:"MuiTooltip"}),{arrow:d=!1,children:S,classes:y,components:I={},componentsProps:A={},describeChild:b=!1,disableFocusListener:C=!1,disableHoverListener:p=!1,disableInteractive:k=!1,disableTouchListener:w=!1,enterDelay:a=100,enterNextDelay:O=0,enterTouchDelay:M=700,followCursor:D=!1,id:m,leaveDelay:F=0,leaveTouchDelay:L=1500,onClose:W,onOpen:N,open:n,placement:t="bottom",PopperComponent:o,PopperProps:u={},slotProps:h={},slots:T={},title:_,TransitionComponent:c,TransitionProps:f,...$}=v,Q=r.isValidElement(S)?S:e.jsx("span",{children:S}),ke=Ct(),st=_t(),[oe,Le]=r.useState(),[Ce,rt]=r.useState(null),ge=r.useRef(!1),_e=k||D,Ne=ye(),Pe=ye(),pe=ye(),Fe=ye(),[it,We]=Pt({controlled:n,default:!1,name:"Tooltip",state:"open"});let U=it;const Te=Tt(m),le=r.useRef(),me=Je(()=>{le.current!==void 0&&(document.body.style.WebkitUserSelect=le.current,le.current=void 0),Fe.clear()});r.useEffect(()=>me,[me]);const $e=x=>{et.clear(),Se=!0,We(!0),N&&!U&&N(x)},fe=Je(x=>{et.start(800+F,()=>{Se=!1}),We(!1),W&&U&&W(x),Ne.start(ke.transitions.duration.shortest,()=>{ge.current=!1})}),xe=x=>{ge.current&&x.type!=="touchstart"||(oe&&oe.removeAttribute("title"),Pe.clear(),pe.clear(),a||Se&&O?Pe.start(Se?O:a,()=>{$e(x)}):$e(x))},Re=x=>{Pe.clear(),pe.start(F,()=>{fe(x)})},[,Be]=r.useState(!1),Ge=x=>{Ve(x.target)||(Be(!1),Re(x))},ze=x=>{oe||Le(x.currentTarget),Ve(x.target)&&(Be(!0),xe(x))},Qe=x=>{ge.current=!0;const z=Q.props;z.onTouchStart&&z.onTouchStart(x)},ot=x=>{Qe(x),pe.clear(),Ne.clear(),me(),le.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",Fe.start(M,()=>{document.body.style.WebkitUserSelect=le.current,xe(x)})},lt=x=>{Q.props.onTouchEnd&&Q.props.onTouchEnd(x),me(),pe.start(L,()=>{fe(x)})};r.useEffect(()=>{if(!U)return;function x(z){z.key==="Escape"&&fe(z)}return document.addEventListener("keydown",x),()=>{document.removeEventListener("keydown",x)}},[fe,U]);const ct=Rt(Ot(Q),Le,g);!_&&_!==0&&(U=!1);const Oe=r.useRef(),dt=x=>{const z=Q.props;z.onMouseMove&&z.onMouseMove(x),ue={x:x.clientX,y:x.clientY},Oe.current&&Oe.current.update()},ce={},De=typeof _=="string";b?(ce.title=!U&&De&&!p?_:null,ce["aria-describedby"]=U?Te:null):(ce["aria-label"]=De?_:null,ce["aria-labelledby"]=U&&!De?Te:null);const B={...ce,...$,...Q.props,className:He($.className,Q.props.className),onTouchStart:Qe,ref:ct,...D?{onMouseMove:dt}:{}},de={};w||(B.onTouchStart=ot,B.onTouchEnd=lt),p||(B.onMouseOver=we(xe,B.onMouseOver),B.onMouseLeave=we(Re,B.onMouseLeave),_e||(de.onMouseOver=xe,de.onMouseLeave=Re)),C||(B.onFocus=we(ze,B.onFocus),B.onBlur=we(Ge,B.onBlur),_e||(de.onFocus=ze,de.onBlur=Ge));const V={...v,isRtl:st,arrow:d,disableInteractive:_e,placement:t,PopperComponentProp:o,touch:ge.current},G=typeof h.popper=="function"?h.popper(V):h.popper,ut=r.useMemo(()=>{var z,Ue;let x=[{name:"arrow",enabled:!!Ce,options:{element:Ce,padding:4}}];return(z=u.popperOptions)!=null&&z.modifiers&&(x=x.concat(u.popperOptions.modifiers)),(Ue=G==null?void 0:G.popperOptions)!=null&&Ue.modifiers&&(x=x.concat(G.popperOptions.modifiers)),{...u.popperOptions,...G==null?void 0:G.popperOptions,modifiers:x}},[Ce,u.popperOptions,G==null?void 0:G.popperOptions]),Me=ea(V),ht=typeof h.transition=="function"?h.transition(V):h.transition,je={slots:{popper:I.Popper,transition:I.Transition??c,tooltip:I.Tooltip,arrow:I.Arrow,...T},slotProps:{arrow:h.arrow??A.arrow,popper:{...u,...G??A.popper},tooltip:h.tooltip??A.tooltip,transition:{...f,...ht??A.transition}}},[gt,pt]=be("popper",{elementType:ta,externalForwardedProps:je,ownerState:V,className:He(Me.popper,u==null?void 0:u.className)}),[mt,ft]=be("transition",{elementType:Vt,externalForwardedProps:je,ownerState:V}),[xt,jt]=be("tooltip",{elementType:aa,className:Me.tooltip,externalForwardedProps:je,ownerState:V}),[yt,bt]=be("arrow",{elementType:na,className:Me.arrow,externalForwardedProps:je,ownerState:V,ref:rt});return e.jsxs(r.Fragment,{children:[r.cloneElement(Q,B),e.jsx(gt,{as:o??nt,placement:t,anchorEl:D?{getBoundingClientRect:()=>({top:ue.y,left:ue.x,right:ue.x,bottom:ue.y,width:0,height:0})}:oe,popperRef:Oe,open:oe?U:!1,id:Te,transition:!0,...de,...pt,popperOptions:ut,children:({TransitionProps:x})=>e.jsx(mt,{timeout:ke.transitions.duration.shorter,...x,...ft,children:e.jsxs(xt,{...jt,children:[_,d?e.jsx(yt,{...bt}):null]})})})]})}),sa=({ordinances:l})=>{const i=()=>{const g=window.open("","_blank");g.document.write(`
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Records Summary</title>
   <style>
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        padding: 30px;
        background-color: #f4f6fa;
        color: #2c3e50;
        line-height: 1.6;
    }

    h2 {
        text-align: center;
        margin-bottom: 30px;
        color: #34495e;
        font-size: 28px;
        letter-spacing: 1px;
    }

    ol {
        padding-left: 0;
        list-style: none;
        max-width: 800px;
        margin: 0 auto;
    }

    .summary-item {
        background: #ffffff;
        padding: 20px;
        margin-bottom: 15px;
        border-left: 6px solid #3498db;
        border-radius: 8px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        transition: background 0.3s ease-in-out;
    }

    .summary-item:hover {
        background: #f9fbfd;
    }

    .summary-item strong {
        color: #2c3e50;
        font-weight: 600;
    }

    .print-btn {
        display: block;
        width: 180px;
        margin: 30px auto;
        padding: 12px 20px;
        text-align: center;
        background: #3498db;
        color: #fff;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 16px;
        font-weight: bold;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        transition: background 0.3s;
    }

    .print-btn:hover {
        background: #2980b9;
    }

    @media print {
        .print-btn { display: none; }
        body {
            background: #fff;
            padding: 0;
            color: #000;
        }
        .summary-item {
            page-break-inside: avoid;
            border-left-color: #000;
            box-shadow: none;
        }
    }
</style>

</head>
<body>

    <div class="summary-container">
        <h2>Records Summary</h2>
        <ol>
            ${l.map(v=>`<li class="summary-item">
                            <strong>Title:</strong> ${v.title} <br/>
                            <strong>Type:</strong> ${v.document_type} <br/>
                            <strong>Date Issued:</strong> ${new Intl.DateTimeFormat("en-US",{dateStyle:"medium"}).format(new Date(v.date_issued))}</br>
                                                        <strong>Details:</strong> ${v.details} 
                        </li>`).join("")}
        </ol>
        <button class="print-btn" onclick="window.print();">Print Summary</button>
    </div>

</body>
</html>

    `),g.document.close()};return e.jsx(P,{onClick:i,style:{marginTop:"10px",padding:"10px",backgroundColor:"#6200ea",color:"white",border:"none",cursor:"pointer",borderRadius:"5px"},children:"Print Summary"})};function ra(){const[l,i]=r.useState([]),[g,v]=r.useState(!1),[d,S]=r.useState(null),[y,I]=r.useState(""),[A,b]=r.useState([]),[C,p]=r.useState(0),[k,w]=r.useState(10),[a,O]=r.useState(!1),[M,D]=r.useState(1),[m,F]=r.useState(""),[L,W]=r.useState(""),[N,n]=r.useState({open:!1,message:"",severity:"info"});r.useEffect(()=>{(async()=>{try{const f=await Et(C+1,k,m);f.ordinances.length===0?(n({message:"No Records found.",severity:"error"}),i([]),b([])):(i(f.ordinances),b(f.ordinances)),D(f.total_pages)}catch{n({message:"An error occurred while fetching ordinances.",severity:"error"})}})()},[C,k,m]),r.useEffect(()=>{const c=l.filter(f=>{const $=f.title.toLowerCase().includes(m.toLowerCase())||f.details.toLowerCase().includes(m.toLowerCase())||f.document_type.toLowerCase().includes(m.toLowerCase())||f.status.toLowerCase().includes(m.toLowerCase())||f.number.toLowerCase().includes(m.toLowerCase()),Q=!L||f.document_type===L;return $&&Q});b(c)},[m,L,l]);const t=(c,f)=>{p(f)},o=c=>{w(parseInt(c.target.value,10)),p(0)},u=async c=>{if(window.confirm("Are you sure you want to delete this record?"))try{await It(c),i(f=>f.filter($=>$.id!==c)),b(f=>f.filter($=>$.id!==c)),n({message:"Record deleted successfully.",severity:"success"})}catch(f){console.error("Error deleting record:",f),n({message:"An error occurred while deleting the record.",severity:"error"})}},h=c=>{W(c.target.value)},T=c=>{F(c.target.value)},_=["All",...new Set(l.map(c=>c.document_type))];return e.jsxs("div",{children:[e.jsxs(J,{display:"flex",justifyContent:"space-between",alignItems:"center",gap:2,flexWrap:"wrap",children:[e.jsxs(J,{children:[e.jsx(j,{label:"Search Record",variant:"outlined",margin:"normal",value:m,onChange:T}),e.jsxs(qt,{variant:"outlined",margin:"normal",sx:{minWidth:200},children:[e.jsx(Kt,{children:"Document Type"}),e.jsx(Yt,{value:L,onChange:h,label:"Document Type",children:_.map((c,f)=>e.jsx(H,{value:c==="All"?"":c,children:c},f))})]})]}),e.jsx(J,{children:e.jsx(sa,{ordinances:A})})]}),e.jsx(ee,{children:e.jsxs(te,{children:[e.jsx(ae,{children:e.jsxs(E,{children:[e.jsx(s,{children:"Title"}),e.jsx(s,{children:"Status"}),e.jsx(s,{children:"Details"}),e.jsx(s,{children:"Series No."}),e.jsx(s,{children:"Document Type"}),e.jsx(s,{children:"Date Issued"}),e.jsx(s,{children:"Actions"})]})}),e.jsx(ne,{children:A.map(c=>e.jsxs(E,{children:[e.jsx(s,{children:c.title}),e.jsx(s,{children:c.status}),e.jsx(s,{children:c.details}),e.jsx(s,{children:c.number}),e.jsx(s,{children:c.document_type}),e.jsx(s,{children:new Date(c.date_issued).toLocaleDateString()}),e.jsxs(s,{children:[c.file_path&&e.jsx(Ae,{title:"Preview File",arrow:!0,children:e.jsx(ve,{onClick:()=>At(c.file_path,I,O),children:e.jsx("img",{src:"/Printer.svg",alt:"preview"})})}),e.jsx(Ae,{title:"Delete Ordinance",arrow:!0,children:e.jsx(ve,{onClick:()=>u(c.id),color:"error",children:e.jsx("img",{src:"/trash.svg",alt:"delete"})})}),e.jsx(Ae,{title:"Edit Ordinance",arrow:!0,children:e.jsx(ve,{onClick:()=>{S(c),v(!0)},color:"primary",children:e.jsx("img",{src:"/edit.svg",alt:"edit"})})})]})]},c.id))})]})}),e.jsx(J,{sx:{position:"absolute",bottom:0,right:0},children:e.jsx(Z,{component:"div",count:M*k,page:C,onPageChange:t,rowsPerPage:k,onRowsPerPageChange:o,rowsPerPageOptions:[10,25,50]})}),e.jsx(se,{open:!!N.message,autoHideDuration:4e3,onClose:()=>n({open:!1,message:"",severity:"info"}),children:e.jsx(re,{onClose:()=>n({open:!1,message:"",severity:"info"}),severity:N.severity||"info",sx:{width:"100%"},children:N.message})}),e.jsxs(q,{open:a,onClose:()=>O(!1),maxWidth:"lg",fullWidth:!0,children:[e.jsxs(K,{children:["Preview Records",e.jsx(ve,{onClick:()=>O(!1),style:{float:"right"},children:e.jsx(Ht,{})})]}),e.jsx(Y,{dividers:!0,children:y?e.jsx("iframe",{src:y,width:"100%",height:"600px",title:"Ordinance Preview",style:{border:"none"}}):e.jsx("p",{children:"No file selected."})})]}),e.jsxs(q,{open:g,onClose:()=>v(!1),fullScreen:!0,children:[e.jsx(K,{children:"Edit Ordinance"}),e.jsxs(Y,{children:[e.jsx(j,{label:"Title",fullWidth:!0,margin:"dense",value:(d==null?void 0:d.title)||"",onChange:c=>S({...d,title:c.target.value})}),e.jsx(j,{label:"Status",fullWidth:!0,margin:"dense",value:(d==null?void 0:d.status)||"",onChange:c=>S({...d,status:c.target.value})}),e.jsx(j,{label:"Details",fullWidth:!0,margin:"dense",value:(d==null?void 0:d.details)||"",onChange:c=>S({...d,details:c.target.value})}),e.jsx(j,{label:"Series No.",fullWidth:!0,margin:"dense",value:(d==null?void 0:d.number)||"",onChange:c=>S({...d,number:c.target.value})}),e.jsx(j,{label:"Document Type",fullWidth:!0,margin:"dense",value:(d==null?void 0:d.document_type)||"",onChange:c=>S({...d,document_type:c.target.value})}),e.jsx(j,{label:"Date Issued",type:"date",fullWidth:!0,margin:"dense",value:d!=null&&d.date_issued?new Date(d.date_issued).toISOString().split("T")[0]:"",onChange:c=>S({...d,date_issued:c.target.value}),InputLabelProps:{shrink:!0}})]}),e.jsxs(ie,{children:[e.jsx(P,{onClick:()=>v(!1),children:"Cancel"}),e.jsx(P,{onClick:()=>handleEditSave(),variant:"contained",color:"primary",children:"Save"})]})]})]})}function ia(){const[l,i]=r.useState([]),[g,v]=r.useState(""),[d,S]=r.useState(0),[y,I]=r.useState(10),[A,b]=r.useState(!0),[C,p]=r.useState({open:!1,message:"",severity:"info"}),[k,w]=r.useState(!1),[a,O]=r.useState(null);r.useEffect(()=>{var u;const t=localStorage.getItem("CoverageRecords");if(t){const h=JSON.parse(t),T=Date.now()-h.cachedAt>1e3*60*5;if(((u=h.ordinances)==null?void 0:u.length)>0&&!T){i(h.ordinances),b(!1);return}}(async()=>{try{const h=await qe();h.length===0?p({open:!0,message:"No Record Found.",severity:"error"}):(p({open:!0,message:"Records fetched Successfully.",severity:"success"}),i(h))}catch{p({open:!0,message:"Error fetching Records.",severity:"error"})}finally{b(!1)}})()},[d,y]),r.useEffect(()=>{localStorage.setItem("CoverageRecords",JSON.stringify({ordinances:l,cachedAt:Date.now()}))},[l]);const M=r.useMemo(()=>l.filter(t=>{var T,_,c;const o=g.toLowerCase(),u=((T=t.title)==null?void 0:T.toLowerCase().includes(o))||((_=t.number)==null?void 0:_.toString().toLowerCase().includes(o)),h=(c=t.coverage_scopes)==null?void 0:c.some(f=>["target_beneficiaries","geographical_coverage","inclusive_period"].some($=>f[$]&&f[$].toLowerCase().includes(o)));return u||h}),[l,g]),D=(t,o)=>{O({id:(o==null?void 0:o.id)||"",ordinance_id:t.id,inclusive_period:(o==null?void 0:o.inclusive_period)||"",target_beneficiaries:(o==null?void 0:o.target_beneficiaries)||"",geographical_coverage:(o==null?void 0:o.geographical_coverage)||""}),w(!0)},m=t=>{O({...a,[t.target.name]:t.target.value})},F=async()=>{try{a.id?(await kt(a.id,a),alert("Record updated successfully!")):(await Lt(a),alert("Record added successfully!")),w(!1),b(!0);const t=await qe(),o={ordinances:t,cachedAt:Date.now()};localStorage.setItem("CoverageRecords",JSON.stringify(o)),i(t),b(!1)}catch(t){p({open:!0,message:"Failed to save Record. Please try again.",severity:"error"}),console.error("Error saving Record:",t)}},L=t=>v(t.target.value),W=(t,o)=>S(o),N=t=>{I(parseInt(t.target.value,10)),S(0)};if(A)return e.jsx(he,{});const n=["City-Wide","Alicaocao","Alinam","Amobocan","Andarayan","Baculod","Baringin Norte","Baringin Sur","Buena Suerte","Bugallon","Buyon","Cabaruan","Cabugao","Carabatan Bacareno","Carabatan Chica","Carabatan Grande","Carabatan Punta","Casalatan","Cassap Fuera","Catalina","Culalabat","Dabburab","De Vera","Dianao","Dissimuray","District I (Poblacion)","District II (Poblacion)","District III (Poblacion)","Duminit","Faustino (Sipay)","Gagabutan","Gappal","Guayabal","Labinab","Linglingay","Mabantad","Maligaya","Manaoag","Marabulig I","Marabulig II","Minante I","Minante II","Nagcampegan","Naganacan","Nagrumbuan","Nungnungan I","Nungnungan II","Pinoma","Rizal","Rizaluna","Rogus","San Antonio","San Fermin (Poblacion)","San Francisco","San Isidro","San Luis","San Pablo (Casap Hacienda)","Santa Luciana (Daburab 2)","Santa Maria","Sillawit","Sinippil","Tagaran","Turayong","Union","Villa Concepcion","Villa Luna","Villaflor"];return e.jsxs("div",{children:[e.jsx(j,{label:"Search Record",variant:"outlined",margin:"normal",value:g,onChange:L}),e.jsx(ee,{children:e.jsxs(te,{children:[e.jsx(ae,{children:e.jsxs(E,{children:[e.jsx(s,{children:"Title"}),e.jsx(s,{children:"Inclusive Period"}),e.jsx(s,{children:"Target Beneficiaries"}),e.jsx(s,{children:"Geographical Coverage"}),e.jsx(s,{children:"Actions"})]})}),e.jsx(ne,{children:M.slice(d*y,d*y+y).flatMap(t=>t.coverage_scopes.length>0?t.coverage_scopes.map(o=>e.jsxs(E,{children:[e.jsxs(s,{children:[t.title," ",t.number]}),e.jsx(s,{children:o.inclusive_period||"No coverage scope added"}),e.jsx(s,{children:o.target_beneficiaries}),e.jsx(s,{children:o.geographical_coverage}),e.jsx(s,{children:e.jsx(P,{variant:"outlined",onClick:()=>D(t,o),children:"Edit"})})]},`${t.id}-${o.id}`)):e.jsxs(E,{children:[e.jsxs(s,{children:[t.title," ",t.number]}),e.jsx(s,{colSpan:3,children:"No record"}),e.jsx(s,{children:e.jsx(P,{variant:"contained",onClick:()=>D(t,null),children:"Add"})})]},t.id))})]})}),e.jsx(J,{sx:{position:"absolute",bottom:0,right:0},children:e.jsx(Z,{rowsPerPageOptions:[10,20,100],component:"div",count:M.length,rowsPerPage:y,page:d,onPageChange:W,onRowsPerPageChange:N})}),e.jsxs(q,{open:k,onClose:()=>w(!1),children:[e.jsxs(K,{children:[a!=null&&a.id?"Edit":"Add"," Coverage Scope"]}),e.jsxs(Y,{children:[e.jsx(j,{label:"Inclusive Period",name:"inclusive_period",value:(a==null?void 0:a.inclusive_period)||"",onChange:m,fullWidth:!0,margin:"normal"}),e.jsx(j,{label:"Target Beneficiaries",name:"target_beneficiaries",value:(a==null?void 0:a.target_beneficiaries)||"General Public",onChange:m,select:!0,fullWidth:!0,margin:"normal",children:["General Public","Women","Children","Solo Parents","PWDs","MSMEs","Others"].map(t=>e.jsx(H,{value:t,children:t},t))}),e.jsx(j,{label:"Geographical Coverage",name:"geographical_coverage",value:(a==null?void 0:a.geographical_coverage)||"",onChange:m,fullWidth:!0,select:!0,margin:"normal",children:n.map(t=>e.jsx(H,{value:t,children:t},t))})]}),e.jsxs(ie,{children:[e.jsx(P,{onClick:()=>w(!1),children:"Cancel"}),e.jsx(P,{variant:"contained",onClick:F,children:"Save"})]})]}),e.jsx(se,{open:C.open,autoHideDuration:4e3,onClose:()=>p({open:!1,message:"",severity:"info"}),children:e.jsx(re,{onClose:()=>p({open:!1,message:"",severity:"info"}),severity:C.severity,sx:{width:"100%"},children:C.message})})]})}function oa(){const[l,i]=r.useState([]),[g,v]=r.useState(""),[d,S]=r.useState(0),[y,I]=r.useState(10),[A,b]=r.useState(!0),[C,p]=r.useState({open:!1,message:"",severity:"info"}),[k,w]=r.useState(!1),[a,O]=r.useState(null);r.useEffect(()=>{var o;const n=localStorage.getItem("ObjectivesRecords");if(n){const u=JSON.parse(n),h=Date.now()-u.cachedAt>1e3*60*5;if(((o=u.ordinances)==null?void 0:o.length)>0&&!h){i(u.ordinances),b(!1);return}}(async()=>{try{const u=await Ke();u.length===0?p({open:!0,message:"No Record Found.",severity:"error"}):(p({open:!0,message:"Records fetched Successfully.",severity:"success"}),i(u))}catch{p({open:!0,message:"Error fetching Records.",severity:"error"})}finally{b(!1)}})()},[d,y]),r.useEffect(()=>{localStorage.setItem("ObjectivesRecords",JSON.stringify({ordinances:l,cachedAt:Date.now()}))},[l]);const M=r.useMemo(()=>l.filter(n=>{var h,T,_;const t=g.toLowerCase(),o=((h=n.title)==null?void 0:h.toLowerCase().includes(t))||((T=n.number)==null?void 0:T.toString().toLowerCase().includes(t)),u=(_=n.objectives_implementation)==null?void 0:_.some(c=>["lead_agency","supporting_agencies","policy_objectives","key_provisions","programs_activities"].some(f=>c[f]&&c[f].toLowerCase().includes(t)));return o||u}),[l,g]),D=(n,t)=>{O({id:(t==null?void 0:t.id)||"",ordinance_id:n.id,policy_objectives:(t==null?void 0:t.policy_objectives)||"",lead_agency:(t==null?void 0:t.lead_agency)||"",supporting_agencies:(t==null?void 0:t.supporting_agencies)||"",key_provisions:(t==null?void 0:t.key_provisions)||"",programs_activities:(t==null?void 0:t.programs_activities)||""}),w(!0)},m=n=>{O({...a,[n.target.name]:n.target.value})},F=async()=>{try{a.id?(await Nt(a.id,a),alert("Coverage scope updated successfully!")):(await Ft(a),alert("Coverage scope added successfully!")),w(!1),b(!0);const n=await Ke(),t={ordinances:n,cachedAt:Date.now()};localStorage.setItem("ObjectivesRecords",JSON.stringify(t)),i(n),b(!1)}catch(n){p({open:!0,message:"Failed to save coverage scope. Please try again.",severity:"error"}),console.error("Error saving coverage scope:",n)}},L=n=>v(n.target.value),W=(n,t)=>S(t),N=n=>{I(parseInt(n.target.value,10)),S(0)};return A?e.jsx(he,{}):e.jsxs("div",{children:[e.jsx(j,{label:"Search Record",variant:"outlined",margin:"normal",value:g,onChange:L}),e.jsx(ee,{children:e.jsxs(te,{children:[e.jsx(ae,{children:e.jsxs(E,{children:[e.jsx(s,{children:"Title"}),e.jsx(s,{children:"Policy Objectives"}),e.jsx(s,{children:"Lead Agency"}),e.jsx(s,{children:"Supporting Agencies"}),e.jsx(s,{children:"Key Provisions"}),e.jsx(s,{children:"Programs/Activities"}),e.jsx(s,{children:"Actions"})]})}),e.jsx(ne,{children:M.slice(d*y,d*y+y).flatMap(n=>n.objectives_implementation.length>0?n.objectives_implementation.map(t=>e.jsxs(E,{children:[e.jsxs(s,{children:[n.title," ",n.number]}),e.jsx(s,{children:t.policy_objectives||"No Objectives Data"}),e.jsx(s,{children:t.lead_agency}),e.jsx(s,{children:t.supporting_agencies}),e.jsx(s,{children:t.key_provisions}),e.jsx(s,{children:t.programs_activities}),e.jsx(s,{children:e.jsx(P,{variant:"outlined",onClick:()=>D(n,t),children:"Edit"})})]},`${n.id}-${t.id}`)):e.jsxs(E,{children:[e.jsxs(s,{children:[n.title," ",n.number]}),e.jsx(s,{colSpan:5,children:"No Objectives/Implementation"}),e.jsx(s,{children:e.jsx(P,{variant:"contained",onClick:()=>D(n,null),children:"Add"})})]},n.id))})]})}),e.jsx(J,{sx:{position:"absolute",bottom:0,right:0},children:e.jsx(Z,{rowsPerPageOptions:[10,20,100],component:"div",count:M.length,rowsPerPage:y,page:d,onPageChange:W,onRowsPerPageChange:N})}),e.jsxs(q,{open:k,onClose:()=>w(!1),children:[e.jsxs(K,{children:[a!=null&&a.id?"Edit":"Add"," Coverage Scope"]}),e.jsxs(Y,{children:[e.jsx(j,{label:"Policy Objectives",name:"policy_objectives",value:(a==null?void 0:a.policy_objectives)||"",onChange:m,fullWidth:!0,margin:"normal"}),e.jsx(j,{label:"Lead Agency ",name:"lead_agency",value:(a==null?void 0:a.lead_agency)||"",onChange:m,fullWidth:!0,margin:"normal"}),e.jsx(j,{label:"Supporting Agencies",name:"supporting_agencies",value:(a==null?void 0:a.supporting_agencies)||"",onChange:m,fullWidth:!0,margin:"normal"}),e.jsx(j,{label:"Key Provisions",name:"key_provisions",value:(a==null?void 0:a.key_provisions)||"",onChange:m,fullWidth:!0,margin:"normal"}),e.jsx(j,{label:"Programs Activities",name:"programs_activities",value:(a==null?void 0:a.programs_activities)||"",onChange:m,fullWidth:!0,margin:"normal"})]}),e.jsxs(ie,{children:[e.jsx(P,{onClick:()=>w(!1),children:"Cancel"}),e.jsx(P,{variant:"contained",onClick:F,children:"Save"})]})]}),e.jsx(se,{open:C.open,autoHideDuration:4e3,onClose:()=>p({open:!1,message:"",severity:"info"}),children:e.jsx(re,{onClose:()=>p({open:!1,message:"",severity:"info"}),severity:C.severity,sx:{width:"100%"},children:C.message})})]})}function la(){const[l,i]=r.useState([]),[g,v]=r.useState(""),[d,S]=r.useState(0),[y,I]=r.useState(10),[A,b]=r.useState(!0),[C,p]=r.useState({open:!1,message:"",severity:"info"}),[k,w]=r.useState(!1),[a,O]=r.useState(null);r.useEffect(()=>{var u;const t=localStorage.getItem("BudgetRecords");if(t){const h=JSON.parse(t),T=Date.now()-h.cachedAt>1e3*60*5;if(((u=h.ordinances)==null?void 0:u.length)>0&&!T){i(h.ordinances),b(!1);return}}(async()=>{try{const h=await Ye();h.length===0?p({open:!0,message:"No Record Found.",severity:"error"}):(p({open:!0,message:"Records fetched Successfully.",severity:"success"}),i(h))}catch{p({open:!0,message:"Error fetching Records.",severity:"error"})}finally{b(!1)}})()},[d,y]),r.useEffect(()=>{localStorage.setItem("BudgetRecords",JSON.stringify({ordinances:l,cachedAt:Date.now()}))},[l]);const M=r.useMemo(()=>l.filter(t=>{var T,_,c;const o=g.toLowerCase(),u=((T=t.title)==null?void 0:T.toLowerCase().includes(o))||((_=t.number)==null?void 0:_.toString().toLowerCase().includes(o)),h=(c=t.budget_allocation)==null?void 0:c.some(f=>["allocated_budget","utilized_budget","gad_budget","financial_transparency_measures"].some($=>f[$]&&f[$].toLowerCase().includes(o)));return u||h}),[l,g]),D=(t,o)=>{O({id:(o==null?void 0:o.id)||"",ordinance_id:t.id,allocated_budget:(o==null?void 0:o.allocated_budget)||"",utilized_budget:(o==null?void 0:o.utilized_budget)||"",gad_budget:(o==null?void 0:o.gad_budget)||"",financial_transparency_measures:(o==null?void 0:o.financial_transparency_measures)||""}),w(!0)},m=t=>{O({...a,[t.target.name]:t.target.value})},F=async()=>{try{a.id?(await Wt(a.id,a),alert("Record updated successfully!")):(await $t(a),alert("Record added successfully!")),w(!1),b(!0);const t=await Ye(),o={ordinances:t,cachedAt:Date.now()};localStorage.setItem("BudgetRecords",JSON.stringify(o)),i(t),b(!1)}catch(t){p({open:!0,message:"Failed to save Record. Please try again.",severity:"error"}),console.error("Error saving Record:",t)}},L=t=>v(t.target.value),W=(t,o)=>S(o),N=t=>{I(parseInt(t.target.value,10)),S(0)};if(A)return e.jsx(he,{});const n=t=>!t||isNaN(t)?"â‚±0.00":new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:2}).format(t);return e.jsxs("div",{children:[e.jsx(j,{label:"Search Record",variant:"outlined",margin:"normal",value:g,onChange:L}),e.jsx(ee,{children:e.jsxs(te,{children:[e.jsx(ae,{children:e.jsxs(E,{children:[e.jsx(s,{children:"Title"}),e.jsx(s,{children:"Allocated Budget"}),e.jsx(s,{children:"Utilized Budget"}),e.jsx(s,{children:"GAD Budget"}),e.jsx(s,{children:"Financial Transparency Measures"}),e.jsx(s,{children:"Actions"})]})}),e.jsx(ne,{children:M.slice(d*y,d*y+y).flatMap(t=>t.budget_allocation.length>0?t.budget_allocation.map(o=>e.jsxs(E,{children:[e.jsxs(s,{children:[t.title," ",t.number]}),e.jsx(s,{children:n(o.allocated_budget)}),e.jsx(s,{children:n(o.utilized_budget)}),e.jsx(s,{children:n(o.gad_budget)}),e.jsx(s,{children:o.financial_transparency_measures}),e.jsx(s,{children:e.jsx(P,{variant:"outlined",onClick:()=>D(t,o),children:"Edit"})})]},`${t.id}-${o.id}`)):e.jsxs(E,{children:[e.jsxs(s,{children:[t.title," ",t.number]}),e.jsx(s,{colSpan:4,children:"No Budget Allocation Data"}),e.jsx(s,{children:e.jsx(P,{variant:"contained",onClick:()=>D(t,null),children:"Add"})})]},t.id))})]})}),e.jsx(J,{sx:{position:"absolute",bottom:0,right:0},children:e.jsx(Z,{rowsPerPageOptions:[10,20,100],component:"div",count:M.length,rowsPerPage:y,page:d,onPageChange:W,onRowsPerPageChange:N})}),e.jsxs(q,{open:k,onClose:()=>w(!1),children:[e.jsxs(K,{children:[a!=null&&a.id?"Edit":"Add"," Coverage Scope"]}),e.jsxs(Y,{children:[e.jsx(j,{label:"Allocated Budget",name:"allocated_budget",type:"number",value:(a==null?void 0:a.allocated_budget)||"",onChange:m,fullWidth:!0,margin:"normal"}),e.jsx(j,{label:"Utilized Budget",type:"number",name:"utilized_budget",value:(a==null?void 0:a.utilized_budget)||"",onChange:m,fullWidth:!0,margin:"normal"}),e.jsx(j,{label:"GAD Budget",type:"number",name:"gad_budget",value:(a==null?void 0:a.gad_budget)||"",onChange:m,fullWidth:!0,margin:"normal"}),e.jsx(j,{label:"Financial Transparency Measures",name:"financial_transparency_measures",value:(a==null?void 0:a.financial_transparency_measures)||"",onChange:m,fullWidth:!0,margin:"normal"})]}),e.jsxs(ie,{children:[e.jsx(P,{onClick:()=>w(!1),children:"Cancel"}),e.jsx(P,{variant:"contained",onClick:F,children:"Save"})]})]}),e.jsx(se,{open:C.open,autoHideDuration:4e3,onClose:()=>p({open:!1,message:"",severity:"info"}),children:e.jsx(re,{onClose:()=>p({open:!1,message:"",severity:"info"}),severity:C.severity,sx:{width:"100%"},children:C.message})})]})}function ca(){const[l,i]=r.useState([]),[g,v]=r.useState(""),[d,S]=r.useState(0),[y,I]=r.useState(10),[A,b]=r.useState(!0),[C,p]=r.useState({open:!1,message:"",severity:"info"}),[k,w]=r.useState(!1),[a,O]=r.useState(null);r.useEffect(()=>{var o;const n=localStorage.getItem("MonitoringRecords");if(n){const u=JSON.parse(n),h=Date.now()-u.cachedAt>1e3*60*5;if(((o=u.ordinances)==null?void 0:o.length)>0&&!h){i(u.ordinances),b(!1);return}}(async()=>{try{const u=await Xe();u.length===0?p({open:!0,message:"No Record Found.",severity:"error"}):(p({open:!0,message:"Records fetched Successfully.",severity:"success"}),i(u))}catch{p({open:!0,message:"Error fetching Records.",severity:"error"})}finally{b(!1)}})()},[d,y]),r.useEffect(()=>{localStorage.setItem("MonitoringRecords",JSON.stringify({ordinances:l,cachedAt:Date.now()}))},[l]);const M=r.useMemo(()=>l.filter(n=>{var h,T,_;const t=g.toLowerCase(),o=((h=n.title)==null?void 0:h.toLowerCase().includes(t))||((T=n.number)==null?void 0:T.toString().toLowerCase().includes(t)),u=(_=n.coverage_scopes)==null?void 0:_.some(c=>["indicators_of_success","monitoring_frequency","compliance_rate","challenges","violations_reports","feedback_mechanisms"].some(f=>c[f]&&c[f].toLowerCase().includes(t)));return o||u}),[l,g]),D=(n,t)=>{O({id:(t==null?void 0:t.id)||"",ordinance_id:n.id,compliance_rate:(t==null?void 0:t.compliance_rate)||"0.00",indicators_of_success:(t==null?void 0:t.indicators_of_success)||"",monitoring_frequency:(t==null?void 0:t.monitoring_frequency)||"Monthly",challenges:(t==null?void 0:t.challenges)||"",violations_reports:(t==null?void 0:t.violations_reports)||"",feedback_mechanisms:(t==null?void 0:t.feedback_mechanisms)||""}),w(!0)},m=n=>{O({...a,[n.target.name]:n.target.value})},F=async()=>{try{a.id?(await Bt(a.id,a),alert("Record updated successfully!")):(await Gt(a),alert("Record added successfully!")),w(!1),b(!0);const n=await Xe(),t={ordinances:n,cachedAt:Date.now()};localStorage.setItem("MonitoringRecords",JSON.stringify(t)),i(n),b(!1)}catch(n){p({open:!0,message:"Failed to save Record. Please try again.",severity:"error"}),console.error("Error saving Record:",n)}},L=n=>v(n.target.value),W=(n,t)=>S(t),N=n=>{I(parseInt(n.target.value,10)),S(0)};return A?e.jsx(he,{}):e.jsxs("div",{children:[e.jsx(j,{label:"Search Record",variant:"outlined",margin:"normal",value:g,onChange:L}),e.jsx(ee,{children:e.jsxs(te,{children:[e.jsx(ae,{children:e.jsxs(E,{children:[e.jsx(s,{children:"Title"}),e.jsx(s,{children:"Indicators of Success"}),e.jsx(s,{children:"Frequency"}),e.jsx(s,{children:"Compliance Rate"}),e.jsx(s,{children:"Challenges"}),e.jsx(s,{children:"Violations"}),e.jsx(s,{children:"Feedback"}),e.jsx(s,{children:"Actions"})]})}),e.jsx(ne,{children:M.slice(d*y,d*y+y).flatMap(n=>n.monitoring_compliance.length>0?n.monitoring_compliance.map(t=>e.jsxs(E,{children:[e.jsxs(s,{children:[n.title," ",n.number]}),e.jsx(s,{children:t.indicators_of_success||"No Monitoring data added"}),e.jsx(s,{children:t.monitoring_frequency}),e.jsx(s,{children:`${t.compliance_rate}%`}),e.jsx(s,{children:t.challenges}),e.jsx(s,{children:t.violations_reports}),e.jsx(s,{children:t.feedback_mechanisms}),e.jsx(s,{children:e.jsx(P,{variant:"outlined",onClick:()=>D(n,t),children:"Edit"})})]},`${n.id}-${t.id}`)):e.jsxs(E,{children:[e.jsxs(s,{children:[n.title," ",n.number]}),e.jsx(s,{colSpan:6,children:"No Monitoring Data"}),e.jsx(s,{children:e.jsx(P,{variant:"contained",onClick:()=>D(n,null),children:"Add"})})]},n.id))})]})}),e.jsx(J,{sx:{position:"absolute",bottom:0,right:0},children:e.jsx(Z,{rowsPerPageOptions:[10,20,100],component:"div",count:M.length,rowsPerPage:y,page:d,onPageChange:W,onRowsPerPageChange:N})}),e.jsxs(q,{open:k,onClose:()=>w(!1),children:[e.jsxs(K,{children:[a!=null&&a.id?"Edit":"Add"," Monitoring Data"]}),e.jsxs(Y,{children:[e.jsx(j,{label:"Indicators of Success",name:"indicators_of_success",value:(a==null?void 0:a.indicators_of_success)||"",onChange:m,fullWidth:!0,margin:"normal"}),e.jsxs(j,{label:"Monitoring Frequency",name:"monitoring_frequency",select:!0,value:(a==null?void 0:a.monitoring_frequency)||"",onChange:m,fullWidth:!0,margin:"normal",children:[e.jsx(H,{value:"Monthly",children:"Monthly"}),e.jsx(H,{value:"Quarterly",children:"Quarterly"}),e.jsx(H,{value:"Yearly",children:"Yearly"})]}),e.jsx(j,{label:"Compliance Rate",name:"compliance_rate",type:"number",value:(a==null?void 0:a.compliance_rate)||"",onChange:n=>{const t=n.target.value;/^\d*\.?\d*$/.test(t)&&m(n)},inputProps:{step:"0.01",min:"0"},fullWidth:!0,margin:"normal"}),e.jsx(j,{label:"Challenges",name:"challenges",value:(a==null?void 0:a.challenges)||"",onChange:m,fullWidth:!0,margin:"normal"}),e.jsx(j,{label:"Violations",name:"violations_reports",value:(a==null?void 0:a.violations_reports)||"",onChange:m,fullWidth:!0,margin:"normal"}),e.jsx(j,{label:"Feedback Mechanisms",name:"feedback_mechanisms",value:(a==null?void 0:a.feedback_mechanisms)||"",onChange:m,fullWidth:!0,margin:"normal"})]}),e.jsxs(ie,{children:[e.jsx(P,{onClick:()=>w(!1),children:"Cancel"}),e.jsx(P,{variant:"contained",onClick:F,children:"Save"})]})]}),e.jsx(se,{open:C.open,autoHideDuration:4e3,onClose:()=>p({open:!1,message:"",severity:"info"}),children:e.jsx(re,{onClose:()=>p({open:!1,message:"",severity:"info"}),severity:C.severity,sx:{width:"100%"},children:C.message})})]})}function da(){const[l,i]=r.useState([]),[g,v]=r.useState(""),[d,S]=r.useState(0),[y,I]=r.useState(10),[A,b]=r.useState(!0),[C,p]=r.useState({open:!1,message:"",severity:"info"}),[k,w]=r.useState(!1),[a,O]=r.useState(null);r.useEffect(()=>{var o;const n=localStorage.getItem("AssessmentRecords");if(n){const u=JSON.parse(n),h=Date.now()-u.cachedAt>1e3*60*5;if(((o=u.ordinances)==null?void 0:o.length)>0&&!h){i(u.ordinances),b(!1);return}}(async()=>{try{const u=await Ze();u.length===0?p({open:!0,message:"No Record Found.",severity:"error"}):(p({open:!0,message:"Records fetched Successfully.",severity:"success"}),i(u))}catch{p({open:!0,message:"Error fetching Records.",severity:"error"})}finally{b(!1)}})()},[d,y]),r.useEffect(()=>{localStorage.setItem("AssessmentRecords",JSON.stringify({ordinances:l,cachedAt:Date.now()}))},[l]);const M=r.useMemo(()=>l.filter(n=>{var h,T,_;const t=g.toLowerCase(),o=((h=n.title)==null?void 0:h.toLowerCase().includes(t))||((T=n.number)==null?void 0:T.toString().toLowerCase().includes(t)),u=(_=n.impact_assessment)==null?void 0:_.some(c=>[].some(f=>c[f]&&c[f].toLowerCase().includes(t)));return o||u}),[l,g]),D=(n,t)=>{O({id:(t==null?void 0:t.id)||"",ordinance_id:n.id,funding_source:(t==null?void 0:t.funding_source)||"General Fund",outcomes_results:(t==null?void 0:t.outcomes_results)||"",gender_responsiveness_impact:(t==null?void 0:t.gender_responsiveness_impact)||"",community_benefits:(t==null?void 0:t.community_benefits)||"",adjustments_needed:(t==null?void 0:t.adjustments_needed)||"",feedback_mechanisms:(t==null?void 0:t.feedback_mechanisms)||""}),w(!0)},m=n=>{O({...a,[n.target.name]:n.target.value})},F=async()=>{try{a.id?(await zt(a.id,a),alert("Record updated successfully!")):(await Qt(a),alert("Record added successfully!")),w(!1),b(!0);const n=await Ze(),t={ordinances:n,cachedAt:Date.now()};localStorage.setItem("AssessmentsRecords",JSON.stringify(t)),i(n),b(!1)}catch(n){p({open:!0,message:"Failed to save Record. Please try again.",severity:"error"}),console.error("Error saving Record:",n)}},L=n=>v(n.target.value),W=(n,t)=>S(t),N=n=>{I(parseInt(n.target.value,10)),S(0)};return A?e.jsx(he,{}):e.jsxs("div",{children:[e.jsx(j,{label:"Search Record",variant:"outlined",margin:"normal",value:g,onChange:L}),e.jsx(ee,{children:e.jsxs(te,{children:[e.jsx(ae,{children:e.jsxs(E,{children:[e.jsx(s,{children:"Title"}),e.jsx(s,{children:"Outcome Results"}),e.jsx(s,{children:"Gender Responsiveness Impact"}),e.jsx(s,{children:"Funding Source"}),e.jsx(s,{children:"Community Benefits"}),e.jsx(s,{children:"Adjustments Needed"}),e.jsx(s,{children:"Actions"})]})}),e.jsx(ne,{children:M.slice(d*y,d*y+y).flatMap(n=>n.impact_assessment.length>0?n.impact_assessment.map(t=>e.jsxs(E,{children:[e.jsxs(s,{children:[n.title," ",n.number]}),e.jsx(s,{children:t.outcomes_results||"No Assessment data added"}),e.jsx(s,{children:t.gender_responsiveness_impact}),e.jsx(s,{children:t.funding_source&&`${t.funding_source}`}),e.jsx(s,{children:t.community_benefits}),e.jsx(s,{children:t.adjustments_needed}),e.jsx(s,{children:e.jsx(P,{variant:"outlined",onClick:()=>D(n,t),children:"Edit"})})]},`${n.id}-${t.id}`)):e.jsxs(E,{children:[e.jsxs(s,{children:[n.title," ",n.number]}),e.jsx(s,{colSpan:5,children:"No Assessment Data"}),e.jsx(s,{children:e.jsx(P,{variant:"contained",onClick:()=>D(n,null),children:"Add"})})]},n.id))})]})}),e.jsx(J,{sx:{position:"absolute",bottom:0,right:0},children:e.jsx(Z,{rowsPerPageOptions:[10,20,100],component:"div",count:M.length,rowsPerPage:y,page:d,onPageChange:W,onRowsPerPageChange:N})}),e.jsxs(q,{open:k,onClose:()=>w(!1),children:[e.jsxs(K,{children:[a!=null&&a.id?"Edit":"Add"," Monitoring Data"]}),e.jsxs(Y,{children:[e.jsx(j,{label:"Outcome Results",name:"outcomes_results",value:(a==null?void 0:a.outcomes_results)||"",onChange:m,fullWidth:!0,margin:"normal"}),e.jsxs(j,{label:"Funding Source",name:"funding_source",select:!0,onChange:m,value:(a==null?void 0:a.funding_source)||"",fullWidth:!0,margin:"normal",children:[e.jsx(H,{value:"General Fund",children:"General Fund"}),e.jsx(H,{value:"Grants",children:"Grants"}),e.jsx(H,{value:"Others",children:"Others"})]}),e.jsx(j,{label:"Gender Responsiveness Impact",name:"gender_responsiveness_impact",value:(a==null?void 0:a.gender_responsiveness_impact)||"",onChange:m,fullWidth:!0,margin:"normal"}),e.jsx(j,{label:"Community Benefits",name:"community_benefits",value:(a==null?void 0:a.community_benefits)||"",onChange:m,fullWidth:!0,margin:"normal"}),e.jsx(j,{label:"Adjustments Needed",name:"adjustments_needed",value:(a==null?void 0:a.adjustments_needed)||"",onChange:m,fullWidth:!0,margin:"normal"}),e.jsx(j,{label:"Feedback Mechanisms",name:"feedback_mechanisms",value:(a==null?void 0:a.feedback_mechanisms)||"",onChange:m,fullWidth:!0,margin:"normal"})]}),e.jsxs(ie,{children:[e.jsx(P,{onClick:()=>w(!1),children:"Cancel"}),e.jsx(P,{variant:"contained",onClick:F,children:"Save"})]})]}),e.jsx(se,{open:C.open,autoHideDuration:4e3,onClose:()=>p({open:!1,message:"",severity:"info"}),children:e.jsx(re,{onClose:()=>p({open:!1,message:"",severity:"info"}),severity:C.severity,sx:{width:"100%"},children:C.message})})]})}function va(){const[l,i]=r.useState(0),g=(v,d)=>{i(d)};return e.jsxs(Ut,{children:[e.jsxs(Jt,{value:l,onChange:g,children:[e.jsx(X,{label:"Records Table"}),e.jsx(X,{label:"Coverage Table"}),e.jsx(X,{label:"Objectives Table"}),e.jsx(X,{label:"Budget Table"}),e.jsx(X,{label:"Records Monitoring Table"}),e.jsx(X,{label:"Impact Assessment Table"})]}),e.jsxs("div",{style:{marginTop:"30px"},children:[l===0&&e.jsx(ra,{formType:"A"}),l===1&&e.jsx(ia,{formType:"B"}),l===2&&e.jsx(oa,{formType:"C"}),l===3&&e.jsx(la,{formType:"D"}),l===4&&e.jsx(ca,{formType:"E"}),l===5&&e.jsx(da,{formType:"F"})]})]})}export{va as default};
