import{a as r,at as S,j as e,O as s,N as o,a3 as l,au as k}from"./index-cjkKFOZm.js";import{T as d}from"./TextField-BfmpNyZ6.js";import{D,a as E,b as W}from"./DialogTitle-WWYLQq1n.js";import{D as L}from"./DialogActions-BZJ2Nsqg.js";const I=({setIsLoggedIn:j})=>{const[b,n]=r.useState(!1),[c,y]=r.useState(""),[g,h]=r.useState(""),[u,i]=r.useState(""),[x,v]=r.useState(""),[m,w]=r.useState(""),[p,f]=r.useState(""),C=S(),F=async t=>{t.preventDefault(),f("");try{await k({username:x,password:m}),sessionStorage.setItem("isLoggedIn","true"),j(!0),C("/dashboard"),setTimeout(()=>{window.location.reload()},100)}catch(a){f(a||"Login failed")}};return e.jsxs(s,{sx:{height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#5D378C",p:2},children:[e.jsxs(s,{sx:{display:{xs:"none",md:"block"},position:"absolute",top:"5%",left:"5%",zIndex:0,justifyContent:"flex-start",textAlign:"left"},children:[e.jsx(o,{variant:"h2",color:"#FF7704",fontWeight:600,children:"Welcome"}),e.jsx(o,{variant:"h4",fontWeight:600,color:"white",children:"Cauayan Cares - Archiving System"}),e.jsx(o,{color:"white",variant:"h6",children:"Preserving Records, Empowering Communities"})]}),e.jsx(s,{sx:{display:{xs:"none",md:"block"},position:"absolute",bottom:"10%",left:"5%",zIndex:0},children:e.jsx("img",{src:"/LoginPoster.svg",alt:"Login Poster",style:{maxWidth:"100%",height:"auto"}})}),e.jsxs(s,{sx:{background:"#FBEAFF",p:4,borderRadius:"10px",width:{xs:"90%",sm:"60%",md:"30%"},minWidth:"300px",boxShadow:3,right:{xs:"0",md:"10%"},position:{xs:"relative",md:"absolute"}},children:[e.jsx(o,{variant:"h5",fontWeight:"bold",color:"#FF7706",gutterBottom:!0,children:"Login"}),e.jsx(o,{color:"textSecondary",mb:2,children:"Please enter your login credentials"}),p&&e.jsx(o,{color:"error",mb:2,children:p}),e.jsxs("form",{onSubmit:F,children:[e.jsx(s,{mb:2,children:e.jsx(d,{fullWidth:!0,type:"text",label:"Username",value:x,onChange:t=>v(t.target.value),required:!0,variant:"outlined"})}),e.jsx(s,{mb:3,children:e.jsx(d,{fullWidth:!0,type:"password",label:"Password",value:m,onChange:t=>w(t.target.value),required:!0,variant:"outlined"})}),e.jsx(l,{type:"submit",variant:"contained",fullWidth:!0,sx:{bgcolor:"#5D378C",color:"#fff",":hover":{bgcolor:"#4B2A6F"}},children:"Login"})]}),e.jsx(o,{variant:"body2",sx:{mt:2,textAlign:"center",cursor:"pointer",color:"#5D378C"},onClick:()=>n(!0),children:"Forgot your password?"})]}),e.jsxs(D,{open:b,onClose:()=>n(!1),children:[e.jsx(E,{children:"Forgot Password"}),e.jsxs(W,{children:[e.jsx(o,{mb:2,children:"Enter your registered email address to receive a password reset link."}),u&&e.jsx(o,{color:"error",mb:2,children:u}),g&&e.jsx(o,{color:"primary",mb:2,children:g}),e.jsx(d,{autoFocus:!0,margin:"dense",label:"Email Address",type:"email",fullWidth:!0,variant:"outlined",value:c,onChange:t=>y(t.target.value)})]}),e.jsxs(L,{children:[e.jsx(l,{onClick:()=>n(!1),children:"Cancel"}),e.jsx(l,{variant:"contained",sx:{bgcolor:"#5D378C",":hover":{bgcolor:"#4B2A6F"}},onClick:async()=>{i(""),h("");try{const t=await fetch("/api/forgot-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:c})}),a=await t.json();t.ok?h(a.message||"Reset link sent."):i(a.error||"Something went wrong.")}catch{i("Network error. Try again later.")}},children:"Send Reset Link"})]})]})]})};export{I as default};
