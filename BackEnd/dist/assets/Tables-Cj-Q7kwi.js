import{B as De,C as Ie,a as i,M as ke,o as e,w as K,H as re,E as Le,N as X,O as Mt,Q as Y,R as it,q as Rt,F as Ot,U as Re,x as At,m as Dt,V as at,y as It,W as kt,X as Lt,Y as be,Z as lt,$ as rt,a0 as ct,a1 as F,a2 as Et,J as B,a3 as Ft,a4 as Wt,a5 as $t,K as se,a6 as Nt,a7 as Bt,a8 as Ut,a9 as Gt,aa as zt,ab as Vt,ac as Qt,ad as Ht,ae as qt,af as Yt,ag as Kt,ah as Xt,ai as Jt,aj as Zt,I as ee,ak as en,al as tn,am as nn,an,ao as Z}from"./index-5TCDiF3V.js";import{G as rn,T as _,F as sn,I as on,S as ln}from"./TextField-DiURoTH6.js";import{M as G}from"./MenuItem-BbSqcsQR.js";import{T as oe,a as ie,b as le,c as N,d as o,e as ce}from"./TableRow-CdjOZCHX.js";import{P as dt}from"./Popper-B8MzpH_q.js";import{I as ze}from"./IconButton-CRjOJGz7.js";import{T as te,C as cn}from"./Close-CzaeKXR8.js";import{D as de,a as ue,b as pe}from"./DialogTitle-NAI1PjZG.js";import{D as ye}from"./DialogActions-CaymgBT0.js";import{S as ve,A as we}from"./Snackbar-CD2nW_wy.js";function dn(a){return De("MuiAccordionDetails",a)}Ie("MuiAccordionDetails",["root"]);const un=a=>{const{classes:r}=a;return Le({root:["root"]},dn,r)},pn=K("div",{name:"MuiAccordionDetails",slot:"Root",overridesResolver:(a,r)=>r.root})(X(({theme:a})=>({padding:a.spacing(1,2,2)}))),hn=i.forwardRef(function(r,c){const h=ke({props:r,name:"MuiAccordionDetails"}),{className:p,...m}=h,u=h,P=un(u);return e.jsx(pn,{className:re(P.root,p),ref:c,ownerState:u,...m})});function mn(a){return De("MuiAccordionSummary",a)}const ae=Ie("MuiAccordionSummary",["root","expanded","focusVisible","disabled","gutters","contentGutters","content","expandIconWrapper"]),gn=a=>{const{classes:r,expanded:c,disabled:h,disableGutters:p}=a;return Le({root:["root",c&&"expanded",h&&"disabled",!p&&"gutters"],focusVisible:["focusVisible"],content:["content",c&&"expanded",!p&&"contentGutters"],expandIconWrapper:["expandIconWrapper",c&&"expanded"]},mn,r)},xn=K(it,{name:"MuiAccordionSummary",slot:"Root",overridesResolver:(a,r)=>r.root})(X(({theme:a})=>{const r={duration:a.transitions.duration.shortest};return{display:"flex",width:"100%",minHeight:48,padding:a.spacing(0,2),transition:a.transitions.create(["min-height","background-color"],r),[`&.${ae.focusVisible}`]:{backgroundColor:(a.vars||a).palette.action.focus},[`&.${ae.disabled}`]:{opacity:(a.vars||a).palette.action.disabledOpacity},[`&:hover:not(.${ae.disabled})`]:{cursor:"pointer"},variants:[{props:c=>!c.disableGutters,style:{[`&.${ae.expanded}`]:{minHeight:64}}}]}})),fn=K("span",{name:"MuiAccordionSummary",slot:"Content",overridesResolver:(a,r)=>r.content})(X(({theme:a})=>({display:"flex",textAlign:"start",flexGrow:1,margin:"12px 0",variants:[{props:r=>!r.disableGutters,style:{transition:a.transitions.create(["margin"],{duration:a.transitions.duration.shortest}),[`&.${ae.expanded}`]:{margin:"20px 0"}}}]}))),jn=K("span",{name:"MuiAccordionSummary",slot:"ExpandIconWrapper",overridesResolver:(a,r)=>r.expandIconWrapper})(X(({theme:a})=>({display:"flex",color:(a.vars||a).palette.action.active,transform:"rotate(0deg)",transition:a.transitions.create("transform",{duration:a.transitions.duration.shortest}),[`&.${ae.expanded}`]:{transform:"rotate(180deg)"}}))),bn=i.forwardRef(function(r,c){const h=ke({props:r,name:"MuiAccordionSummary"}),{children:p,className:m,expandIcon:u,focusVisibleClassName:P,onClick:w,slots:A,slotProps:v,...y}=h,{disabled:D=!1,disableGutters:j,expanded:n,toggle:M}=i.useContext(Mt),f=l=>{M&&M(l),w&&w(l)},T={...h,expanded:n,disabled:D,disableGutters:j},R=gn(T),g={slots:A,slotProps:v},[S,C]=Y("root",{ref:c,shouldForwardComponentProp:!0,className:re(R.root,m),elementType:xn,externalForwardedProps:{...g,...y},ownerState:T,additionalProps:{focusRipple:!1,disableRipple:!0,disabled:D,"aria-expanded":n,focusVisibleClassName:re(R.focusVisible,P)},getSlotProps:l=>({...l,onClick:I=>{var d;(d=l.onClick)==null||d.call(l,I),f(I)}})}),[L,$]=Y("content",{className:R.content,elementType:fn,externalForwardedProps:g,ownerState:T}),[s,t]=Y("expandIconWrapper",{className:R.expandIconWrapper,elementType:jn,externalForwardedProps:g,ownerState:T});return e.jsxs(S,{...C,children:[e.jsx(L,{...$,children:p}),u&&e.jsx(s,{...t,children:u})]})});function yn(a){return De("MuiTooltip",a)}const E=Ie("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]);function vn(a){return Math.round(a*1e5)/1e5}const wn=a=>{const{classes:r,disableInteractive:c,arrow:h,touch:p,placement:m}=a,u={popper:["popper",!c&&"popperInteractive",h&&"popperArrow"],tooltip:["tooltip",h&&"tooltipArrow",p&&"touch",`tooltipPlacement${be(m.split("-")[0])}`],arrow:["arrow"]};return Le(u,yn,r)},Sn=K(dt,{name:"MuiTooltip",slot:"Popper",overridesResolver:(a,r)=>{const{ownerState:c}=a;return[r.popper,!c.disableInteractive&&r.popperInteractive,c.arrow&&r.popperArrow,!c.open&&r.popperClose]}})(X(({theme:a})=>({zIndex:(a.vars||a).zIndex.tooltip,pointerEvents:"none",variants:[{props:({ownerState:r})=>!r.disableInteractive,style:{pointerEvents:"auto"}},{props:({open:r})=>!r,style:{pointerEvents:"none"}},{props:({ownerState:r})=>r.arrow,style:{[`&[data-popper-placement*="bottom"] .${E.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${E.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${E.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}},[`&[data-popper-placement*="left"] .${E.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}}}},{props:({ownerState:r})=>r.arrow&&!r.isRtl,style:{[`&[data-popper-placement*="right"] .${E.arrow}`]:{left:0,marginLeft:"-0.71em"}}},{props:({ownerState:r})=>r.arrow&&!!r.isRtl,style:{[`&[data-popper-placement*="right"] .${E.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:r})=>r.arrow&&!r.isRtl,style:{[`&[data-popper-placement*="left"] .${E.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:r})=>r.arrow&&!!r.isRtl,style:{[`&[data-popper-placement*="left"] .${E.arrow}`]:{left:0,marginLeft:"-0.71em"}}}]}))),Cn=K("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(a,r)=>{const{ownerState:c}=a;return[r.tooltip,c.touch&&r.touch,c.arrow&&r.tooltipArrow,r[`tooltipPlacement${be(c.placement.split("-")[0])}`]]}})(X(({theme:a})=>({backgroundColor:a.vars?a.vars.palette.Tooltip.bg:lt(a.palette.grey[700],.92),borderRadius:(a.vars||a).shape.borderRadius,color:(a.vars||a).palette.common.white,fontFamily:a.typography.fontFamily,padding:"4px 8px",fontSize:a.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:a.typography.fontWeightMedium,[`.${E.popper}[data-popper-placement*="left"] &`]:{transformOrigin:"right center"},[`.${E.popper}[data-popper-placement*="right"] &`]:{transformOrigin:"left center"},[`.${E.popper}[data-popper-placement*="top"] &`]:{transformOrigin:"center bottom",marginBottom:"14px"},[`.${E.popper}[data-popper-placement*="bottom"] &`]:{transformOrigin:"center top",marginTop:"14px"},variants:[{props:({ownerState:r})=>r.arrow,style:{position:"relative",margin:0}},{props:({ownerState:r})=>r.touch,style:{padding:"8px 16px",fontSize:a.typography.pxToRem(14),lineHeight:`${vn(16/14)}em`,fontWeight:a.typography.fontWeightRegular}},{props:({ownerState:r})=>!r.isRtl,style:{[`.${E.popper}[data-popper-placement*="left"] &`]:{marginRight:"14px"},[`.${E.popper}[data-popper-placement*="right"] &`]:{marginLeft:"14px"}}},{props:({ownerState:r})=>!r.isRtl&&r.touch,style:{[`.${E.popper}[data-popper-placement*="left"] &`]:{marginRight:"24px"},[`.${E.popper}[data-popper-placement*="right"] &`]:{marginLeft:"24px"}}},{props:({ownerState:r})=>!!r.isRtl,style:{[`.${E.popper}[data-popper-placement*="left"] &`]:{marginLeft:"14px"},[`.${E.popper}[data-popper-placement*="right"] &`]:{marginRight:"14px"}}},{props:({ownerState:r})=>!!r.isRtl&&r.touch,style:{[`.${E.popper}[data-popper-placement*="left"] &`]:{marginLeft:"24px"},[`.${E.popper}[data-popper-placement*="right"] &`]:{marginRight:"24px"}}},{props:({ownerState:r})=>r.touch,style:{[`.${E.popper}[data-popper-placement*="top"] &`]:{marginBottom:"24px"}}},{props:({ownerState:r})=>r.touch,style:{[`.${E.popper}[data-popper-placement*="bottom"] &`]:{marginTop:"24px"}}}]}))),_n=K("span",{name:"MuiTooltip",slot:"Arrow",overridesResolver:(a,r)=>r.arrow})(X(({theme:a})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:a.vars?a.vars.palette.Tooltip.bg:lt(a.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}})));let Oe=!1;const st=new Lt;let fe={x:0,y:0};function Ae(a,r){return(c,...h)=>{r&&r(c,...h),a(c,...h)}}const q=i.forwardRef(function(r,c){const h=ke({props:r,name:"MuiTooltip"}),{arrow:p=!1,children:m,classes:u,components:P={},componentsProps:w={},describeChild:A=!1,disableFocusListener:v=!1,disableHoverListener:y=!1,disableInteractive:D=!1,disableTouchListener:j=!1,enterDelay:n=100,enterNextDelay:M=0,enterTouchDelay:f=700,followCursor:T=!1,id:R,leaveDelay:g=0,leaveTouchDelay:S=1500,onClose:C,onOpen:L,open:$,placement:s="bottom",PopperComponent:t,PopperProps:l={},slotProps:I={},slots:d={},title:b,TransitionComponent:O,TransitionProps:k,...W}=h,U=i.isValidElement(m)?m:e.jsx("span",{children:m}),Qe=Rt(),ut=Ot(),[he,He]=i.useState(),[Ee,pt]=i.useState(null),Se=i.useRef(!1),Fe=D||T,qe=Re(),We=Re(),Ce=Re(),Ye=Re(),[ht,Ke]=At({controlled:$,default:!1,name:"Tooltip",state:"open"});let H=ht;const $e=Dt(R),me=i.useRef(),_e=at(()=>{me.current!==void 0&&(document.body.style.WebkitUserSelect=me.current,me.current=void 0),Ye.clear()});i.useEffect(()=>_e,[_e]);const Xe=x=>{st.clear(),Oe=!0,Ke(!0),L&&!H&&L(x)},Pe=at(x=>{st.start(800+g,()=>{Oe=!1}),Ke(!1),C&&H&&C(x),qe.start(Qe.transitions.duration.shortest,()=>{Se.current=!1})}),Te=x=>{Se.current&&x.type!=="touchstart"||(he&&he.removeAttribute("title"),We.clear(),Ce.clear(),n||Oe&&M?We.start(Oe?M:n,()=>{Xe(x)}):Xe(x))},Ne=x=>{We.clear(),Ce.start(g,()=>{Pe(x)})},[,Je]=i.useState(!1),Ze=x=>{rt(x.target)||(Je(!1),Ne(x))},et=x=>{he||He(x.currentTarget),rt(x.target)&&(Je(!0),Te(x))},tt=x=>{Se.current=!0;const Q=U.props;Q.onTouchStart&&Q.onTouchStart(x)},mt=x=>{tt(x),Ce.clear(),qe.clear(),_e(),me.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",Ye.start(f,()=>{document.body.style.WebkitUserSelect=me.current,Te(x)})},gt=x=>{U.props.onTouchEnd&&U.props.onTouchEnd(x),_e(),Ce.start(S,()=>{Pe(x)})};i.useEffect(()=>{if(!H)return;function x(Q){Q.key==="Escape"&&Pe(Q)}return document.addEventListener("keydown",x),()=>{document.removeEventListener("keydown",x)}},[Pe,H]);const xt=It(kt(U),He,c);!b&&b!==0&&(H=!1);const Be=i.useRef(),ft=x=>{const Q=U.props;Q.onMouseMove&&Q.onMouseMove(x),fe={x:x.clientX,y:x.clientY},Be.current&&Be.current.update()},ge={},Ue=typeof b=="string";A?(ge.title=!H&&Ue&&!y?b:null,ge["aria-describedby"]=H?$e:null):(ge["aria-label"]=Ue?b:null,ge["aria-labelledby"]=H&&!Ue?$e:null);const z={...ge,...W,...U.props,className:re(W.className,U.props.className),onTouchStart:tt,ref:xt,...T?{onMouseMove:ft}:{}},xe={};j||(z.onTouchStart=mt,z.onTouchEnd=gt),y||(z.onMouseOver=Ae(Te,z.onMouseOver),z.onMouseLeave=Ae(Ne,z.onMouseLeave),Fe||(xe.onMouseOver=Te,xe.onMouseLeave=Ne)),v||(z.onFocus=Ae(et,z.onFocus),z.onBlur=Ae(Ze,z.onBlur),Fe||(xe.onFocus=et,xe.onBlur=Ze));const J={...h,isRtl:ut,arrow:p,disableInteractive:Fe,placement:s,PopperComponentProp:t,touch:Se.current},V=typeof I.popper=="function"?I.popper(J):I.popper,jt=i.useMemo(()=>{var Q,nt;let x=[{name:"arrow",enabled:!!Ee,options:{element:Ee,padding:4}}];return(Q=l.popperOptions)!=null&&Q.modifiers&&(x=x.concat(l.popperOptions.modifiers)),(nt=V==null?void 0:V.popperOptions)!=null&&nt.modifiers&&(x=x.concat(V.popperOptions.modifiers)),{...l.popperOptions,...V==null?void 0:V.popperOptions,modifiers:x}},[Ee,l.popperOptions,V==null?void 0:V.popperOptions]),Ge=wn(J),bt=typeof I.transition=="function"?I.transition(J):I.transition,Me={slots:{popper:P.Popper,transition:P.Transition??O,tooltip:P.Tooltip,arrow:P.Arrow,...d},slotProps:{arrow:I.arrow??w.arrow,popper:{...l,...V??w.popper},tooltip:I.tooltip??w.tooltip,transition:{...k,...bt??w.transition}}},[yt,vt]=Y("popper",{elementType:Sn,externalForwardedProps:Me,ownerState:J,className:re(Ge.popper,l==null?void 0:l.className)}),[wt,St]=Y("transition",{elementType:rn,externalForwardedProps:Me,ownerState:J}),[Ct,_t]=Y("tooltip",{elementType:Cn,className:Ge.tooltip,externalForwardedProps:Me,ownerState:J}),[Pt,Tt]=Y("arrow",{elementType:_n,className:Ge.arrow,externalForwardedProps:Me,ownerState:J,ref:pt});return e.jsxs(i.Fragment,{children:[i.cloneElement(U,z),e.jsx(yt,{as:t??dt,placement:s,anchorEl:T?{getBoundingClientRect:()=>({top:fe.y,left:fe.x,right:fe.x,bottom:fe.y,width:0,height:0})}:he,popperRef:Be,open:he?H:!1,id:$e,transition:!0,...xe,...vt,popperOptions:jt,children:({TransitionProps:x})=>e.jsx(wt,{timeout:Qe.transitions.duration.shorter,...x,...St,children:e.jsxs(Ct,{..._t,children:[b,p?e.jsx(Pt,{...Tt}):null]})})})]})}),Pn=ct(e.jsx("path",{d:"M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"}),"ArrowDownward");function Tn(a){return De("MuiTableSortLabel",a)}const Ve=Ie("MuiTableSortLabel",["root","active","icon","iconDirectionDesc","iconDirectionAsc","directionDesc","directionAsc"]),Mn=a=>{const{classes:r,direction:c,active:h}=a,p={root:["root",h&&"active",`direction${be(c)}`],icon:["icon",`iconDirection${be(c)}`]};return Le(p,Tn,r)},Rn=K(it,{name:"MuiTableSortLabel",slot:"Root",overridesResolver:(a,r)=>{const{ownerState:c}=a;return[r.root,c.active&&r.active]}})(X(({theme:a})=>({cursor:"pointer",display:"inline-flex",justifyContent:"flex-start",flexDirection:"inherit",alignItems:"center","&:focus":{color:(a.vars||a).palette.text.secondary},"&:hover":{color:(a.vars||a).palette.text.secondary,[`& .${Ve.icon}`]:{opacity:.5}},[`&.${Ve.active}`]:{color:(a.vars||a).palette.text.primary,[`& .${Ve.icon}`]:{opacity:1,color:(a.vars||a).palette.text.secondary}}}))),On=K("span",{name:"MuiTableSortLabel",slot:"Icon",overridesResolver:(a,r)=>{const{ownerState:c}=a;return[r.icon,r[`iconDirection${be(c.direction)}`]]}})(X(({theme:a})=>({fontSize:18,marginRight:4,marginLeft:4,opacity:0,transition:a.transitions.create(["opacity","transform"],{duration:a.transitions.duration.shorter}),userSelect:"none",variants:[{props:{direction:"desc"},style:{transform:"rotate(0deg)"}},{props:{direction:"asc"},style:{transform:"rotate(180deg)"}}]}))),je=i.forwardRef(function(r,c){const h=ke({props:r,name:"MuiTableSortLabel"}),{active:p=!1,children:m,className:u,direction:P="asc",hideSortIcon:w=!1,IconComponent:A=Pn,slots:v={},slotProps:y={},...D}=h,j={...h,active:p,direction:P,hideSortIcon:w,IconComponent:A},n=Mn(j),M={slots:v,slotProps:y},[f,T]=Y("root",{elementType:Rn,externalForwardedProps:M,ownerState:j,className:re(n.root,u),ref:c}),[R,g]=Y("icon",{elementType:On,externalForwardedProps:M,ownerState:j,className:n.icon});return e.jsxs(f,{disableRipple:!0,component:"span",...T,...D,children:[m,w&&!p?null:e.jsx(R,{as:A,...g})]})}),An=ct(e.jsx("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore"),Dn=({ordinances:a})=>{const r=()=>{const c=window.open("","_blank");c.document.write(`
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Records Summary</title>
   <style>
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        padding: 30px;
        background-color: #f4f6fa;
        color: #2c3e50;
        line-height: 1.6;
    }

    h2 {
        text-align: center;
        margin-bottom: 30px;
        color: #34495e;
        font-size: 28px;
        letter-spacing: 1px;
    }

    ol {
        padding-left: 0;
        list-style: none;
        max-width: 800px;
        margin: 0 auto;
    }

    .summary-item {
        background: #ffffff;
        padding: 20px;
        margin-bottom: 15px;
        border-left: 6px solid #3498db;
        border-radius: 8px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        transition: background 0.3s ease-in-out;
    }

    .summary-item:hover {
        background: #f9fbfd;
    }

    .summary-item strong {
        color: #2c3e50;
        font-weight: 600;
    }

    .print-btn {
        display: block;
        width: 180px;
        margin: 30px auto;
        padding: 12px 20px;
        text-align: center;
        background: #3498db;
        color: #fff;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 16px;
        font-weight: bold;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        transition: background 0.3s;
    }

    .print-btn:hover {
        background: #2980b9;
    }

    @media print {
        .print-btn { display: none; }
        body {
            background: #fff;
            padding: 0;
            color: #000;
        }
        .summary-item {
            page-break-inside: avoid;
            border-left-color: #000;
            box-shadow: none;
        }
    }
</style>

</head>
<body>

    <div class="summary-container">
        <h2>Records Summary</h2>
        <ol>
            ${a.map(h=>`<li class="summary-item">
                            <strong>Title:</strong> ${h.title} <br/>
                            <strong>Type:</strong> ${h.document_type} <br/>
                            <strong>Date Issued:</strong> ${new Intl.DateTimeFormat("en-US",{dateStyle:"medium"}).format(new Date(h.date_issued))}</br>
                                                        <strong>Details:</strong> ${h.details} 
                        </li>`).join("")}
        </ol>
        <button class="print-btn" onclick="window.print();">Print Summary</button>
    </div>

</body>
</html>

    `),c.document.close()};return e.jsx(F,{onClick:r,style:{marginTop:"10px",padding:"10px",backgroundColor:"#6200ea",color:"white",border:"none",cursor:"pointer",borderRadius:"5px"},children:"Print Summary"})},In=()=>{const[a,r]=i.useState([]),[c,h]=i.useState(!1),[p,m]=i.useState(""),[u,P]=i.useState(""),[w,A]=i.useState(""),[v,y]=i.useState(0),[D,j]=i.useState(10),[n,M]=i.useState("asc"),[f,T]=i.useState("title"),[R,g]=i.useState();console.log(R),i.useEffect(()=>{S(v+1,D)},[v,D]);const S=async(d,b)=>{try{const O=await Et(d,b);r(O.ordinances),g(O.total_pages)}catch(O){console.error("Error fetching ordinances:",O)}},C=async d=>{if(window.confirm("Are you sure you want to delete this record?"))try{await Wt(d),S()}catch(b){console.error("Error deleting record:",b)}},L=d=>{P(d.target.value)},$=d=>{A(d.target.value)},s=(d,b)=>{y(b)},t=d=>{j(parseInt(d.target.value,10)),y(0)},l=d=>{M(f===d&&n==="asc"?"desc":"asc"),T(d)},I=i.useMemo(()=>a.filter(d=>Object.entries(d).filter(([b])=>b!=="id").some(([,b])=>b!=null)).filter(d=>{const b=Object.entries(d).filter(([k])=>k!=="file_path").some(([k,W])=>W&&W.toString().toLowerCase().includes(u.toLowerCase())),O=!w||d.document_type===w;return b&&O}).sort((d,b)=>{let O=d[f]??"",k=b[f]??"";return f==="date_issued"&&(O=new Date(O||0),k=new Date(k||0)),O<k?n==="asc"?-1:1:O>k?n==="asc"?1:-1:0}),[a,u,w,f,n]);return e.jsxs("div",{children:[e.jsxs(B,{display:"flex",justifyContent:"space-between",alignItems:"center",gap:2,flexWrap:"wrap",children:[e.jsxs(B,{children:[e.jsx(_,{label:"Search Record",variant:"outlined",margin:"normal",value:u,onChange:L}),e.jsxs(sn,{variant:"outlined",margin:"normal",sx:{minWidth:200},children:[e.jsx(on,{children:"Document Type"}),e.jsxs(ln,{value:w,onChange:$,label:"Document Type",children:[e.jsx(G,{value:"",children:"All"}),e.jsx(G,{value:"Ordinance",children:"Ordinance"}),e.jsx(G,{value:"Resolution",children:"Resolution"}),e.jsx(G,{value:"Executive Order",children:"Executive Order"}),e.jsx(G,{value:"Memo",children:"Memo"})]})]})]}),e.jsx(B,{children:e.jsx(Dn,{ordinances:I})})]}),e.jsx(oe,{children:e.jsxs(ie,{stickyHeader:!0,size:"medium",children:[e.jsx(le,{children:e.jsxs(N,{children:[e.jsx(o,{children:e.jsx(je,{active:f==="title",direction:f==="title"?n:"asc",onClick:()=>l("title"),children:"Title"})}),e.jsx(o,{children:e.jsx(je,{active:f==="document_type",direction:f==="document_type"?n:"asc",onClick:()=>l("document_type"),children:"Type of Document"})}),e.jsx(o,{children:e.jsx(je,{active:f==="number",direction:f==="number"?n:"asc",onClick:()=>l("number"),children:"Number"})}),e.jsx(o,{children:e.jsx(je,{active:f==="details",direction:f==="details"?n:"asc",onClick:()=>l("details"),children:"Details"})}),e.jsx(o,{children:e.jsx(je,{active:f==="date_issued",direction:f==="date_issued"?n:"asc",onClick:()=>l("date_issued"),children:"Date Issued"})}),e.jsx(o,{children:"Date of Effectivity"}),e.jsx(o,{children:"Status"}),e.jsx(o,{children:"Actions"})]})}),e.jsx(ce,{children:I.slice(v*D,v*D+D).map(d=>e.jsxs(N,{hover:!0,children:[e.jsx(o,{children:e.jsx(q,{title:d.title,arrow:!0,children:e.jsx("span",{style:{display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"180px"},children:d.title})})}),e.jsx(o,{children:e.jsx(q,{title:d.document_type,arrow:!0,children:e.jsx("span",{style:{display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"180px"},children:d.document_type})})}),e.jsx(o,{children:e.jsx(q,{title:d.number,arrow:!0,children:e.jsx("span",{style:{display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"120px"},children:d.number})})}),e.jsx(o,{children:e.jsx(q,{title:d.details,arrow:!0,children:e.jsx("span",{style:{display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"200px"},children:d.details})})}),e.jsx(o,{children:e.jsx(q,{title:new Intl.DateTimeFormat("en-US",{dateStyle:"medium"}).format(new Date(d.date_issued)),arrow:!0,children:e.jsx("span",{children:new Intl.DateTimeFormat("en-US",{dateStyle:"medium"}).format(new Date(d.date_issued))})})}),e.jsx(o,{children:e.jsx(q,{title:new Intl.DateTimeFormat("en-US",{dateStyle:"medium"}).format(new Date(d.date_effectivity)),arrow:!0,children:e.jsx("span",{children:new Intl.DateTimeFormat("en-US",{dateStyle:"medium"}).format(new Date(d.date_effectivity))})})}),e.jsx(o,{children:e.jsx(q,{title:d.status,arrow:!0,children:e.jsx("span",{children:d.status})})}),e.jsxs(o,{children:[d.file_path&&e.jsx(q,{title:"Preview File",arrow:!0,children:e.jsx(ze,{onClick:()=>Ft(d.file_path,m,h),children:e.jsx("img",{src:"/Printer.svg",alt:"preview"})})}),e.jsx(q,{title:"Delete Ordinance",arrow:!0,children:e.jsx(ze,{onClick:()=>C(d.id),color:"error",children:e.jsx("img",{src:"/trash.svg",alt:"delete"})})})]})]},d.id))})]})}),e.jsx(B,{sx:{position:"absolute",bottom:0,right:0},children:e.jsx(te,{rowsPerPageOptions:[10,20,100],component:"div",count:R,rowsPerPage:D,page:v,onPageChange:s,onRowsPerPageChange:t})}),e.jsxs(de,{open:c,onClose:()=>h(!1),maxWidth:"lg",fullWidth:!0,children:[e.jsxs(ue,{children:["Preview Records",e.jsx(ze,{onClick:()=>h(!1),style:{float:"right"},children:e.jsx(cn,{})})]}),e.jsx(pe,{dividers:!0,children:p?e.jsx("iframe",{src:p,width:"100%",height:"600px",title:"Ordinance Preview",style:{border:"none"}}):e.jsx("p",{children:"No file selected."})})]})]})};function kn(){const[a,r]=i.useState([]),[c,h]=i.useState(""),[p,m]=i.useState(0),[u,P]=i.useState(10),[w,A]=i.useState(!0),[v,y]=i.useState({open:!1,message:"",severity:"info"}),[D,j]=i.useState(!1),[n,M]=i.useState(null);i.useEffect(()=>{f()},[]);const f=async()=>{try{const t=await $t();r(t||[])}catch{y({open:!0,message:"No Ordinance Found.",severity:"error"})}finally{A(!1)}},T=i.useMemo(()=>a.filter(t=>{var b,O,k;const l=c.toLowerCase(),I=((b=t.title)==null?void 0:b.toLowerCase().includes(l))||((O=t.number)==null?void 0:O.toString().toLowerCase().includes(l)),d=(k=t.coverage_scopes)==null?void 0:k.some(W=>["target_beneficiaries","geographical_coverage","inclusive_period"].some(U=>W[U]&&W[U].toLowerCase().includes(l)));return I||d}),[a,c]),R=(t,l)=>{M({id:(l==null?void 0:l.id)||"",ordinance_id:t.id,inclusive_period:(l==null?void 0:l.inclusive_period)||"",target_beneficiaries:(l==null?void 0:l.target_beneficiaries)||"General Public",geographical_coverage:(l==null?void 0:l.geographical_coverage)||""}),j(!0)},g=t=>{M({...n,[t.target.name]:t.target.value})},S=async()=>{try{n.id?(await Nt(n.id,n),alert("Coverage scope updated successfully!")):(await Bt(n),alert("Coverage scope added successfully!")),j(!1),A(!0),f()}catch(t){y({open:!0,message:"Failed to save coverage scope. Please try again.",severity:"error"}),console.error("Error saving coverage scope:",t)}},C=t=>h(t.target.value),L=(t,l)=>m(l),$=t=>{P(parseInt(t.target.value,10)),m(0)};if(w)return e.jsx(se,{});const s=["City-Wide","Alicaocao","Alinam","Amobocan","Andarayan","Baculod","Baringin Norte","Baringin Sur","Buena Suerte","Bugallon","Buyon","Cabaruan","Cabugao","Carabatan Bacareno","Carabatan Chica","Carabatan Grande","Carabatan Punta","Casalatan","Cassap Fuera","Catalina","Culalabat","Dabburab","De Vera","Dianao","Dissimuray","District I (Poblacion)","District II (Poblacion)","District III (Poblacion)","Duminit","Faustino (Sipay)","Gagabutan","Gappal","Guayabal","Labinab","Linglingay","Mabantad","Maligaya","Manaoag","Marabulig I","Marabulig II","Minante I","Minante II","Nagcampegan","Naganacan","Nagrumbuan","Nungnungan I","Nungnungan II","Pinoma","Rizal","Rizaluna","Rogus","San Antonio","San Fermin (Poblacion)","San Francisco","San Isidro","San Luis","San Pablo (Casap Hacienda)","Santa Luciana (Daburab 2)","Santa Maria","Sillawit","Sinippil","Tagaran","Turayong","Union","Villa Concepcion","Villa Luna","Villaflor"];return e.jsxs("div",{children:[e.jsx(_,{label:"Search Record",variant:"outlined",margin:"normal",value:c,onChange:C}),e.jsx(oe,{children:e.jsxs(ie,{children:[e.jsx(le,{children:e.jsxs(N,{children:[e.jsx(o,{children:"Title"}),e.jsx(o,{children:"Inclusive Period"}),e.jsx(o,{children:"Target Beneficiaries"}),e.jsx(o,{children:"Geographical Coverage"}),e.jsx(o,{children:"Actions"})]})}),e.jsx(ce,{children:T.slice(p*u,p*u+u).flatMap(t=>t.coverage_scopes.length>0?t.coverage_scopes.map(l=>e.jsxs(N,{children:[e.jsxs(o,{children:[t.title," ",t.number]}),e.jsx(o,{children:l.inclusive_period||"No coverage scope added"}),e.jsx(o,{children:l.target_beneficiaries}),e.jsx(o,{children:l.geographical_coverage}),e.jsx(o,{children:e.jsx(F,{variant:"outlined",onClick:()=>R(t,l),children:"Edit"})})]},`${t.id}-${l.id}`)):e.jsxs(N,{children:[e.jsxs(o,{children:[t.title," ",t.number]}),e.jsx(o,{colSpan:3,children:"No coverage scope available"}),e.jsx(o,{children:e.jsx(F,{variant:"contained",onClick:()=>R(t,null),children:"Add"})})]},t.id))})]})}),e.jsx(B,{sx:{position:"absolute",bottom:0,right:0},children:e.jsx(te,{rowsPerPageOptions:[10,20,100],component:"div",count:T.length,rowsPerPage:u,page:p,onPageChange:L,onRowsPerPageChange:$})}),e.jsxs(de,{open:D,onClose:()=>j(!1),children:[e.jsxs(ue,{children:[n!=null&&n.id?"Edit":"Add"," Coverage Scope"]}),e.jsxs(pe,{children:[e.jsx(_,{label:"Inclusive Period",name:"inclusive_period",value:(n==null?void 0:n.inclusive_period)||"",onChange:g,fullWidth:!0,margin:"normal"}),e.jsx(_,{label:"Target Beneficiaries",name:"target_beneficiaries",value:(n==null?void 0:n.target_beneficiaries)||"General Public",onChange:g,select:!0,fullWidth:!0,margin:"normal",children:["General Public","Women","Children","Solo Parents","PWDs","MSMEs","Others"].map(t=>e.jsx(G,{value:t,children:t},t))}),e.jsx(_,{label:"Geographical Coverage",name:"geographical_coverage",value:(n==null?void 0:n.geographical_coverage)||"",onChange:g,fullWidth:!0,select:!0,margin:"normal",children:s.map(t=>e.jsx(G,{value:t,children:t},t))})]}),e.jsxs(ye,{children:[e.jsx(F,{onClick:()=>j(!1),children:"Cancel"}),e.jsx(F,{variant:"contained",onClick:S,children:"Save"})]})]}),e.jsx(ve,{open:v.open,autoHideDuration:4e3,onClose:()=>y({open:!1,message:"",severity:"info"}),children:e.jsx(we,{onClose:()=>y({open:!1,message:"",severity:"info"}),severity:v.severity,sx:{width:"100%"},children:v.message})})]})}function Ln(){const[a,r]=i.useState([]),[c,h]=i.useState(""),[p,m]=i.useState(0),[u,P]=i.useState(10),[w,A]=i.useState(!0),[v,y]=i.useState({open:!1,message:"",severity:"info"}),[D,j]=i.useState(!1),[n,M]=i.useState(null);i.useEffect(()=>{f()},[]);const f=async()=>{try{const s=await Ut();r(s||[])}catch{y({open:!0,message:"No Ordinance Found.",severity:"error"})}finally{A(!1)}},T=i.useMemo(()=>a.filter(s=>{var d,b,O;const t=c.toLowerCase(),l=((d=s.title)==null?void 0:d.toLowerCase().includes(t))||((b=s.number)==null?void 0:b.toString().toLowerCase().includes(t)),I=(O=s.objectives_implementation)==null?void 0:O.some(k=>["lead_agency","supporting_agencies","policy_objectives","key_provisions","programs_activities"].some(W=>k[W]&&k[W].toLowerCase().includes(t)));return l||I}),[a,c]),R=(s,t)=>{M({id:(t==null?void 0:t.id)||"",ordinance_id:s.id,policy_objectives:(t==null?void 0:t.policy_objectives)||"",lead_agency:(t==null?void 0:t.lead_agency)||"",supporting_agencies:(t==null?void 0:t.supporting_agencies)||"",key_provisions:(t==null?void 0:t.key_provisions)||"",programs_activities:(t==null?void 0:t.programs_activities)||""}),j(!0)},g=s=>{M({...n,[s.target.name]:s.target.value})},S=async()=>{try{n.id?(await Gt(n.id,n),alert("Coverage scope updated successfully!")):(await zt(n),alert("Coverage scope added successfully!")),j(!1),A(!0),f()}catch(s){y({open:!0,message:"Failed to save coverage scope. Please try again.",severity:"error"}),console.error("Error saving coverage scope:",s)}},C=s=>h(s.target.value),L=(s,t)=>m(t),$=s=>{P(parseInt(s.target.value,10)),m(0)};return w?e.jsx(se,{}):e.jsxs("div",{children:[e.jsx(_,{label:"Search Record",variant:"outlined",margin:"normal",value:c,onChange:C}),e.jsx(oe,{children:e.jsxs(ie,{children:[e.jsx(le,{children:e.jsxs(N,{children:[e.jsx(o,{children:"Title"}),e.jsx(o,{children:"Policy Objectives"}),e.jsx(o,{children:"Lead Agency"}),e.jsx(o,{children:"Supporting Agencies"}),e.jsx(o,{children:"Key Provisions"}),e.jsx(o,{children:"Programs/Activities"}),e.jsx(o,{children:"Actions"})]})}),e.jsx(ce,{children:T.slice(p*u,p*u+u).flatMap(s=>s.objectives_implementation.length>0?s.objectives_implementation.map(t=>e.jsxs(N,{children:[e.jsxs(o,{children:[s.title," ",s.number]}),console.log(t),e.jsx(o,{children:t.policy_objectives||"No Objectives Data"}),e.jsx(o,{children:t.lead_agency}),e.jsx(o,{children:t.supporting_agencies}),e.jsx(o,{children:t.key_provisions}),e.jsx(o,{children:t.programs_activities}),e.jsx(o,{children:e.jsx(F,{variant:"outlined",onClick:()=>R(s,t),children:"Edit"})})]},`${s.id}-${t.id}`)):e.jsxs(N,{children:[e.jsxs(o,{children:[s.title," ",s.number]}),e.jsx(o,{colSpan:5,children:"No Objectives/Implementation"}),e.jsx(o,{children:e.jsx(F,{variant:"contained",onClick:()=>R(s,null),children:"Add"})})]},s.id))})]})}),e.jsx(B,{sx:{position:"absolute",bottom:0,right:0},children:e.jsx(te,{rowsPerPageOptions:[10,20,100],component:"div",count:T.length,rowsPerPage:u,page:p,onPageChange:L,onRowsPerPageChange:$})}),e.jsxs(de,{open:D,onClose:()=>j(!1),children:[e.jsxs(ue,{children:[n!=null&&n.id?"Edit":"Add"," Coverage Scope"]}),e.jsxs(pe,{children:[e.jsx(_,{label:"Policy Objectives",name:"policy_objectives",value:(n==null?void 0:n.policy_objectives)||"",onChange:g,fullWidth:!0,margin:"normal"}),e.jsx(_,{label:"Lead Agency ",name:"lead_agency",value:(n==null?void 0:n.lead_agency)||"",onChange:g,fullWidth:!0,margin:"normal"}),e.jsx(_,{label:"Supporting Agencies",name:"supporting_agencies",value:(n==null?void 0:n.supporting_agencies)||"",onChange:g,fullWidth:!0,margin:"normal"}),e.jsx(_,{label:"Key Provisions",name:"key_provisions",value:(n==null?void 0:n.key_provisions)||"",onChange:g,fullWidth:!0,margin:"normal"}),e.jsx(_,{label:"Programs Activities",name:"programs_activities",value:(n==null?void 0:n.programs_activities)||"",onChange:g,fullWidth:!0,margin:"normal"})]}),e.jsxs(ye,{children:[e.jsx(F,{onClick:()=>j(!1),children:"Cancel"}),e.jsx(F,{variant:"contained",onClick:S,children:"Save"})]})]}),e.jsx(ve,{open:v.open,autoHideDuration:4e3,onClose:()=>y({open:!1,message:"",severity:"info"}),children:e.jsx(we,{onClose:()=>y({open:!1,message:"",severity:"info"}),severity:v.severity,sx:{width:"100%"},children:v.message})})]})}function En(){const[a,r]=i.useState([]),[c,h]=i.useState(""),[p,m]=i.useState(0),[u,P]=i.useState(10),[w,A]=i.useState(!0),[v,y]=i.useState({open:!1,message:"",severity:"info"}),[D,j]=i.useState(!1),[n,M]=i.useState(null);i.useEffect(()=>{f()},[]);const f=async()=>{try{const t=await Vt();r(t||[])}catch{y({open:!0,message:"No Ordinance Found.",severity:"error"})}finally{A(!1)}},T=i.useMemo(()=>a.filter(t=>{var b,O,k;const l=c.toLowerCase(),I=((b=t.title)==null?void 0:b.toLowerCase().includes(l))||((O=t.number)==null?void 0:O.toString().toLowerCase().includes(l)),d=(k=t.budget_allocation)==null?void 0:k.some(W=>["allocated_budget","utilized_budget","gad_budget","financial_transparency_measures"].some(U=>W[U]&&W[U].toLowerCase().includes(l)));return I||d}),[a,c]),R=(t,l)=>{M({id:(l==null?void 0:l.id)||"",ordinance_id:t.id,allocated_budget:(l==null?void 0:l.allocated_budget)||"",utilized_budget:(l==null?void 0:l.utilized_budget)||"",gad_budget:(l==null?void 0:l.gad_budget)||"",financial_transparency_measures:(l==null?void 0:l.financial_transparency_measures)||""}),j(!0)},g=t=>{M({...n,[t.target.name]:t.target.value})},S=async()=>{try{n.id?(await Qt(n.id,n),alert("Coverage scope updated successfully!")):(await Ht(n),alert("Coverage scope added successfully!")),j(!1),A(!0),f()}catch(t){y({open:!0,message:"Failed to save coverage scope. Please try again.",severity:"error"}),console.error("Error saving coverage scope:",t)}},C=t=>h(t.target.value),L=(t,l)=>m(l),$=t=>{P(parseInt(t.target.value,10)),m(0)};if(w)return e.jsx(se,{});const s=t=>!t||isNaN(t)?"â‚±0.00":new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:2}).format(t);return e.jsxs("div",{children:[e.jsx(_,{label:"Search Record",variant:"outlined",margin:"normal",value:c,onChange:C}),e.jsx(oe,{children:e.jsxs(ie,{children:[e.jsx(le,{children:e.jsxs(N,{children:[e.jsx(o,{children:"Title"}),e.jsx(o,{children:"Allocated Budget"}),e.jsx(o,{children:"Utilized Budget"}),e.jsx(o,{children:"GAD Budget"}),e.jsx(o,{children:"Financial Transparency Measures"}),e.jsx(o,{children:"Actions"})]})}),e.jsx(ce,{children:T.slice(p*u,p*u+u).flatMap(t=>t.budget_allocation.length>0?t.budget_allocation.map(l=>e.jsxs(N,{children:[e.jsxs(o,{children:[t.title," ",t.number]}),e.jsx(o,{children:s(l.allocated_budget)}),e.jsx(o,{children:s(l.utilized_budget)}),e.jsx(o,{children:s(l.gad_budget)}),e.jsx(o,{children:l.financial_transparency_measures}),e.jsx(o,{children:e.jsx(F,{variant:"outlined",onClick:()=>R(t,l),children:"Edit"})})]},`${t.id}-${l.id}`)):e.jsxs(N,{children:[e.jsxs(o,{children:[t.title," ",t.number]}),e.jsx(o,{colSpan:4,children:"No Budget Allocation Data"}),e.jsx(o,{children:e.jsx(F,{variant:"contained",onClick:()=>R(t,null),children:"Add"})})]},t.id))})]})}),e.jsx(B,{sx:{position:"absolute",bottom:0,right:0},children:e.jsx(te,{rowsPerPageOptions:[10,20,100],component:"div",count:T.length,rowsPerPage:u,page:p,onPageChange:L,onRowsPerPageChange:$})}),e.jsxs(de,{open:D,onClose:()=>j(!1),children:[e.jsxs(ue,{children:[n!=null&&n.id?"Edit":"Add"," Coverage Scope"]}),e.jsxs(pe,{children:[e.jsx(_,{label:"Allocated Budget",name:"allocated_budget",type:"number",value:(n==null?void 0:n.allocated_budget)||"",onChange:g,fullWidth:!0,margin:"normal"}),e.jsx(_,{label:"Utilized Budget",type:"number",name:"utilized_budget",value:(n==null?void 0:n.utilized_budget)||"",onChange:g,fullWidth:!0,margin:"normal"}),e.jsx(_,{label:"GAD Budget",type:"number",name:"gad_budget",value:(n==null?void 0:n.gad_budget)||"",onChange:g,fullWidth:!0,margin:"normal"}),e.jsx(_,{label:"Financial Transparency Measures",name:"financial_transparency_measures",value:(n==null?void 0:n.financial_transparency_measures)||"",onChange:g,fullWidth:!0,margin:"normal"})]}),e.jsxs(ye,{children:[e.jsx(F,{onClick:()=>j(!1),children:"Cancel"}),e.jsx(F,{variant:"contained",onClick:S,children:"Save"})]})]}),e.jsx(ve,{open:v.open,autoHideDuration:4e3,onClose:()=>y({open:!1,message:"",severity:"info"}),children:e.jsx(we,{onClose:()=>y({open:!1,message:"",severity:"info"}),severity:v.severity,sx:{width:"100%"},children:v.message})})]})}function Fn(){const[a,r]=i.useState([]),[c,h]=i.useState(""),[p,m]=i.useState(0),[u,P]=i.useState(10),[w,A]=i.useState(!0),[v,y]=i.useState({open:!1,message:"",severity:"info"}),[D,j]=i.useState(!1),[n,M]=i.useState(null);i.useEffect(()=>{f()},[]);const f=async()=>{try{const s=await qt();r(s||[])}catch{y({open:!0,message:"No Ordinance Found.",severity:"error"})}finally{A(!1)}},T=i.useMemo(()=>a.filter(s=>{var d,b,O;const t=c.toLowerCase(),l=((d=s.title)==null?void 0:d.toLowerCase().includes(t))||((b=s.number)==null?void 0:b.toString().toLowerCase().includes(t)),I=(O=s.coverage_scopes)==null?void 0:O.some(k=>["indicators_of_success","monitoring_frequency","compliance_rate","challenges","violations_reports","feedback_mechanisms"].some(W=>k[W]&&k[W].toLowerCase().includes(t)));return l||I}),[a,c]),R=(s,t)=>{M({id:(t==null?void 0:t.id)||"",ordinance_id:s.id,compliance_rate:(t==null?void 0:t.compliance_rate)||"0.00",indicators_of_success:(t==null?void 0:t.indicators_of_success)||"",monitoring_frequency:(t==null?void 0:t.monitoring_frequency)||"Monthly",challenges:(t==null?void 0:t.challenges)||"",violations_reports:(t==null?void 0:t.violations_reports)||"",feedback_mechanisms:(t==null?void 0:t.feedback_mechanisms)||""}),j(!0)},g=s=>{M({...n,[s.target.name]:s.target.value})},S=async()=>{try{n.id?(await Yt(n.id,n),alert("Monitoring Data updated successfully!")):(await Kt(n),alert("Monitoring Data added successfully!")),j(!1),A(!0),f()}catch(s){y({open:!0,message:"Failed to save Monitoring Data. Please try again.",severity:"error"}),console.error("Error saving Monitoring Data:",s)}},C=s=>h(s.target.value),L=(s,t)=>m(t),$=s=>{P(parseInt(s.target.value,10)),m(0)};return w?e.jsx(se,{}):e.jsxs("div",{children:[e.jsx(_,{label:"Search Record",variant:"outlined",margin:"normal",value:c,onChange:C}),e.jsx(oe,{children:e.jsxs(ie,{children:[e.jsx(le,{children:e.jsxs(N,{children:[e.jsx(o,{children:"Title"}),e.jsx(o,{children:"Indicators of Success"}),e.jsx(o,{children:"Frequency"}),e.jsx(o,{children:"Compliance Rate"}),e.jsx(o,{children:"Challenges"}),e.jsx(o,{children:"Violations"}),e.jsx(o,{children:"Feedback"}),e.jsx(o,{children:"Actions"})]})}),e.jsx(ce,{children:T.slice(p*u,p*u+u).flatMap(s=>s.monitoring_compliance.length>0?s.monitoring_compliance.map(t=>e.jsxs(N,{children:[e.jsxs(o,{children:[s.title," ",s.number]}),console.log(t),e.jsx(o,{children:t.indicators_of_success||"No Monitoring data added"}),e.jsx(o,{children:t.monitoring_frequency}),e.jsx(o,{children:`${t.compliance_rate}%`}),e.jsx(o,{children:t.challenges}),e.jsx(o,{children:t.violations_reports}),e.jsx(o,{children:t.feedback_mechanisms}),e.jsx(o,{children:e.jsx(F,{variant:"outlined",onClick:()=>R(s,t),children:"Edit"})})]},`${s.id}-${t.id}`)):e.jsxs(N,{children:[e.jsxs(o,{children:[s.title," ",s.number]}),e.jsx(o,{colSpan:6,children:"No Monitoring Data"}),e.jsx(o,{children:e.jsx(F,{variant:"contained",onClick:()=>R(s,null),children:"Add"})})]},s.id))})]})}),e.jsx(B,{sx:{position:"absolute",bottom:0,right:0},children:e.jsx(te,{rowsPerPageOptions:[10,20,100],component:"div",count:T.length,rowsPerPage:u,page:p,onPageChange:L,onRowsPerPageChange:$})}),e.jsxs(de,{open:D,onClose:()=>j(!1),children:[e.jsxs(ue,{children:[n!=null&&n.id?"Edit":"Add"," Monitoring Data"]}),e.jsxs(pe,{children:[e.jsx(_,{label:"Indicators of Success",name:"indicators_of_success",value:(n==null?void 0:n.indicators_of_success)||"",onChange:g,fullWidth:!0,margin:"normal"}),e.jsxs(_,{label:"Monitoring Frequency",name:"monitoring_frequency",select:!0,value:(n==null?void 0:n.monitoring_frequency)||"",onChange:g,fullWidth:!0,margin:"normal",children:[e.jsx(G,{value:"Monthly",children:"Monthly"}),e.jsx(G,{value:"Quarterly",children:"Quarterly"}),e.jsx(G,{value:"Yearly",children:"Yearly"})]}),e.jsx(_,{label:"Compliance Rate",name:"compliance_rate",type:"number",value:(n==null?void 0:n.compliance_rate)||"",onChange:s=>{const t=s.target.value;/^\d*\.?\d*$/.test(t)&&g(s)},inputProps:{step:"0.01",min:"0"},fullWidth:!0,margin:"normal"}),e.jsx(_,{label:"Challenges",name:"challenges",value:(n==null?void 0:n.challenges)||"",onChange:g,fullWidth:!0,margin:"normal"}),e.jsx(_,{label:"Violations",name:"violations_reports",value:(n==null?void 0:n.violations_reports)||"",onChange:g,fullWidth:!0,margin:"normal"}),e.jsx(_,{label:"Feedback Mechanisms",name:"feedback_mechanisms",value:(n==null?void 0:n.feedback_mechanisms)||"",onChange:g,fullWidth:!0,margin:"normal"})]}),e.jsxs(ye,{children:[e.jsx(F,{onClick:()=>j(!1),children:"Cancel"}),e.jsx(F,{variant:"contained",onClick:S,children:"Save"})]})]}),e.jsx(ve,{open:v.open,autoHideDuration:4e3,onClose:()=>y({open:!1,message:"",severity:"info"}),children:e.jsx(we,{onClose:()=>y({open:!1,message:"",severity:"info"}),severity:v.severity,sx:{width:"100%"},children:v.message})})]})}function Wn(){const[a,r]=i.useState([]),[c,h]=i.useState(""),[p,m]=i.useState(0),[u,P]=i.useState(10),[w,A]=i.useState(!0),[v,y]=i.useState({open:!1,message:"",severity:"info"}),[D,j]=i.useState(!1),[n,M]=i.useState(null);i.useEffect(()=>{f()},[]);const f=async()=>{try{const s=await Xt();r(s||[])}catch{y({open:!0,message:"No Ordinance Found.",severity:"error"})}finally{A(!1)}},T=i.useMemo(()=>a.filter(s=>{var d,b,O;const t=c.toLowerCase(),l=((d=s.title)==null?void 0:d.toLowerCase().includes(t))||((b=s.number)==null?void 0:b.toString().toLowerCase().includes(t)),I=(O=s.impact_assessment)==null?void 0:O.some(k=>[].some(W=>k[W]&&k[W].toLowerCase().includes(t)));return l||I}),[a,c]),R=(s,t)=>{M({id:(t==null?void 0:t.id)||"",ordinance_id:s.id,funding_source:(t==null?void 0:t.funding_source)||"General Fund",outcomes_results:(t==null?void 0:t.outcomes_results)||"",gender_responsiveness_impact:(t==null?void 0:t.gender_responsiveness_impact)||"",community_benefits:(t==null?void 0:t.community_benefits)||"",adjustments_needed:(t==null?void 0:t.adjustments_needed)||"",feedback_mechanisms:(t==null?void 0:t.feedback_mechanisms)||""}),j(!0)},g=s=>{M({...n,[s.target.name]:s.target.value})},S=async()=>{try{n.id?(await Jt(n.id,n),alert("Monitoring Data updated successfully!")):(await Zt(n),alert("Monitoring Data added successfully!")),j(!1),A(!0),f()}catch(s){y({open:!0,message:"Failed to save Monitoring Data. Please try again.",severity:"error"}),console.error("Error saving Monitoring Data:",s)}},C=s=>h(s.target.value),L=(s,t)=>m(t),$=s=>{P(parseInt(s.target.value,10)),m(0)};return w?e.jsx(se,{}):e.jsxs("div",{children:[e.jsx(_,{label:"Search Record",variant:"outlined",margin:"normal",value:c,onChange:C}),e.jsx(oe,{children:e.jsxs(ie,{children:[e.jsx(le,{children:e.jsxs(N,{children:[e.jsx(o,{children:"Title"}),e.jsx(o,{children:"Outcome Results"}),e.jsx(o,{children:"Gender Responsiveness Impact"}),e.jsx(o,{children:"Funding Source"}),e.jsx(o,{children:"Community Benefits"}),e.jsx(o,{children:"Adjustments Needed"}),e.jsx(o,{children:"Actions"})]})}),e.jsx(ce,{children:T.slice(p*u,p*u+u).flatMap(s=>s.impact_assessment.length>0?s.impact_assessment.map(t=>e.jsxs(N,{children:[e.jsxs(o,{children:[s.title," ",s.number]}),e.jsx(o,{children:t.outcomes_results||"No Assessment data added"}),e.jsx(o,{children:t.gender_responsiveness_impact}),e.jsx(o,{children:t.funding_source&&`${t.funding_source}%`}),e.jsx(o,{children:t.community_benefits}),e.jsx(o,{children:t.adjustments_needed}),e.jsx(o,{children:e.jsx(F,{variant:"outlined",onClick:()=>R(s,t),children:"Edit"})})]},`${s.id}-${t.id}`)):e.jsxs(N,{children:[e.jsxs(o,{children:[s.title," ",s.number]}),e.jsx(o,{colSpan:5,children:"No Assessment Data"}),e.jsx(o,{children:e.jsx(F,{variant:"contained",onClick:()=>R(s,null),children:"Add"})})]},s.id))})]})}),e.jsx(B,{sx:{position:"absolute",bottom:0,right:0},children:e.jsx(te,{rowsPerPageOptions:[10,20,100],component:"div",count:T.length,rowsPerPage:u,page:p,onPageChange:L,onRowsPerPageChange:$})}),e.jsxs(de,{open:D,onClose:()=>j(!1),children:[e.jsxs(ue,{children:[n!=null&&n.id?"Edit":"Add"," Monitoring Data"]}),e.jsxs(pe,{children:[e.jsx(_,{label:"Outcome Results",name:"outcomes_results",value:(n==null?void 0:n.outcomes_results)||"",onChange:g,fullWidth:!0,margin:"normal"}),e.jsxs(_,{label:"Funding Source",name:"funding_source",select:!0,onChange:g,value:(n==null?void 0:n.funding_source)||"",fullWidth:!0,margin:"normal",children:[e.jsx(G,{value:"Monthly",children:"General Fund"}),e.jsx(G,{value:"Quarterly",children:"Grants"}),e.jsx(G,{value:"Yearly",children:"Others"})]}),e.jsx(_,{label:"Gender Responsiveness Impact",name:"gender_responsiveness_impact",value:(n==null?void 0:n.gender_responsiveness_impact)||"",onChange:g,fullWidth:!0,margin:"normal"}),e.jsx(_,{label:"Community Benefits",name:"community_benefits",value:(n==null?void 0:n.community_benefits)||"",onChange:g,fullWidth:!0,margin:"normal"}),e.jsx(_,{label:"Adjustments Needed",name:"adjustments_needed",value:(n==null?void 0:n.adjustments_needed)||"",onChange:g,fullWidth:!0,margin:"normal"}),e.jsx(_,{label:"Feedback Mechanisms",name:"feedback_mechanisms",value:(n==null?void 0:n.feedback_mechanisms)||"",onChange:g,fullWidth:!0,margin:"normal"})]}),e.jsxs(ye,{children:[e.jsx(F,{onClick:()=>j(!1),children:"Cancel"}),e.jsx(F,{variant:"contained",onClick:S,children:"Save"})]})]}),e.jsx(ve,{open:v.open,autoHideDuration:4e3,onClose:()=>y({open:!1,message:"",severity:"info"}),children:e.jsx(we,{onClose:()=>y({open:!1,message:"",severity:"info"}),severity:v.severity,sx:{width:"100%"},children:v.message})})]})}function $n(){const[a,r]=i.useState([]),[c,h]=i.useState([]),[p,m]=i.useState(0),[u,P]=i.useState(10),[w,A]=i.useState(""),[v,y]=i.useState(0),[D,j]=i.useState(!0),[n,M]=i.useState(null);i.useEffect(()=>{(async()=>{j(!0);try{const C=await tn();C&&Array.isArray(C)?(r(C),h(C)):M("Invalid data received.")}catch(C){console.error("Error fetching data:",C),M("Failed to fetch data.")}finally{j(!1)}})()},[]),i.useEffect(()=>{const S=a.filter(C=>{var L,$;return($=(L=C.ordinance)==null?void 0:L.title)==null?void 0:$.toLowerCase().includes(w.toLowerCase())});h(S),m(0)},[w,a]);const f=c.slice(p*u,p*u+u),T=(S,C)=>{m(C)},R=S=>{P(parseInt(S.target.value,10)),m(0)},g=S=>{A(S.target.value)};return D?e.jsx(se,{sx:{m:2}}):n?e.jsx(ee,{color:"error",sx:{mt:2},children:n}):a.length?e.jsxs("div",{children:[e.jsx(_,{label:"Search by Ordinance Title",variant:"outlined",value:w,onChange:g,margin:"normal"}),e.jsx(B,{sx:{height:"500px",overflowY:"auto"},children:f.map((S,C)=>{var L;return e.jsxs(en,{sx:{backgroundColor:"#fafafa"},expanded:v===C,onChange:()=>y(v===C?null:C),children:[e.jsx(bn,{expandIcon:e.jsx(An,{}),children:e.jsxs(ee,{fontWeight:"bold",children:["ðŸ§¾ ",((L=S.ordinance)==null?void 0:L.title)||"Untitled Ordinance"]})}),e.jsx(hn,{children:e.jsxs(B,{ml:2,children:[e.jsx(ne,{title:"ðŸ“Œ Ordinance Details",data:S.ordinance}),e.jsx(ne,{title:"ðŸŽ¯ Objectives",data:S.objectives}),e.jsx(ne,{title:"ðŸ“Š Monitoring",data:S.monitoring}),e.jsx(ne,{title:"ðŸ“ˆ Impact Assessment",data:S.assessment}),e.jsx(ne,{title:"ðŸ—ºï¸ Coverage Scope",data:S.coverage}),e.jsx(ne,{title:"ðŸ’° Budget Allocation",data:S.budget})]})})]},C)})}),e.jsx(B,{sx:{position:"absolute",bottom:0,right:0},children:e.jsx(te,{component:"div",count:c.length,page:p,onPageChange:T,rowsPerPage:u,onRowsPerPageChange:R,rowsPerPageOptions:[10,20,100]})})]}):e.jsx(ee,{variant:"body2",sx:{mt:2},children:"No records found."})}const ne=({title:a,data:r,isArray:c=!1})=>{if(!r||Array.isArray(r)&&r.length===0)return null;const h=m=>Object.entries(m).filter(([u,P])=>!["id","ordinance_id","file_path"].includes(u)&&P!==null&&P!==void 0&&P!=="");if(c){const m=r.map(h).filter(u=>u.length>0);return m.length===0?null:e.jsxs(B,{mt:2,width:"1000px",children:[e.jsx(ee,{variant:"subtitle1",fontWeight:"bold",gutterBottom:!0,children:a}),m.map((u,P)=>e.jsx(B,{p:2,mb:1,sx:{border:"1px solid #ddd",borderRadius:"8px",backgroundColor:"#f9f9f9",overflowX:"auto"},children:u.map(([w,A])=>e.jsxs(ee,{variant:"body2",children:[e.jsxs("strong",{children:[ot(w),":"]})," ",String(A)]},w))},P))]})}const p=h(r);return p.length===0?null:e.jsxs(B,{mt:2,width:"1000px",children:[e.jsx(ee,{variant:"subtitle1",fontWeight:"bold",gutterBottom:!0,children:a}),e.jsx(B,{p:2,sx:{border:"1px solid #ddd",borderRadius:"8px",backgroundColor:"#f9f9f9",overflowX:"auto"},children:p.map(([m,u])=>e.jsxs(ee,{variant:"body2",children:[e.jsxs("strong",{children:[ot(m),":"]})," ",String(u)]},m))})]})},ot=a=>a.replace(/_/g," ").replace(/\b\w/g,r=>r.toUpperCase());function Kn(){const[a,r]=i.useState(0),c=(h,p)=>{r(p)};return e.jsxs(nn,{children:[e.jsxs(an,{value:a,onChange:c,children:[e.jsx(Z,{label:"All Records"}),e.jsx(Z,{label:"Records Table"}),e.jsx(Z,{label:"Coverage Table"}),e.jsx(Z,{label:"Objectives Table"}),e.jsx(Z,{label:"Budget Table"}),e.jsx(Z,{label:"Records Monitoring Table"}),e.jsx(Z,{label:"Impact Assessment Table"})]}),e.jsxs("div",{style:{marginTop:"30px"},children:[a===0&&e.jsx($n,{formType:"A"}),a===1&&e.jsx(In,{formType:"B"}),a===2&&e.jsx(kn,{formType:"C"}),a===3&&e.jsx(Ln,{formType:"D"}),a===4&&e.jsx(En,{formType:"E"}),a===5&&e.jsx(Fn,{formType:"F"}),a===6&&e.jsx(Wn,{formType:"G"})]})]})}export{Kn as default};
