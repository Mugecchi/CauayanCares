import{q as St,k as Ct,a as i,s as Pt,A as Tt,H as Rt,R as Pe,C as Dt,z as Ot,S as Ve,D as Mt,U as At,j as e,b as Je,V as Te,t as Le,W as kt,X as it,i as Et,v as Fe,w as ot,Y as Ye,Z as R,K,$ as Re,a0 as It,a1 as $t,a2 as Nt,a3 as Lt,a4 as je,a5 as Ke,a6 as Ft,a7 as Wt,a8 as Xe,a9 as Bt,aa as zt,ab as Ze,ac as Gt,ad as Ut,ae as et,af as Qt,ag as Ht,ah as tt,ai as qt,aj as Vt,ak as Jt,al as Yt,am as re}from"./index-C8JWgRoo.js";import{T as se,C as Kt}from"./TablePagination-GrZPxRGK.js";import{G as Xt,T as j,F as at,I as nt,S as rt}from"./TextField-BohWtvo1.js";import{M as U}from"./MenuItem-iCOh6lfQ.js";import{T as ie,a as oe,b as le,c as L,d as s,e as ce}from"./TableRow-Dpjbb2Q3.js";import{P as lt}from"./Popper-_leVqn1l.js";import{S as de,A as ue}from"./Snackbar-DjSpNZEz.js";import{D as te,a as ae,b as ne}from"./DialogTitle-B9vAwaz6.js";import{D as he}from"./DialogActions-DYjaLRLY.js";function Zt(l){return Ct("MuiTooltip",l)}const D=St("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]);function ea(l){return Math.round(l*1e5)/1e5}const ta=l=>{const{classes:o,disableInteractive:h,arrow:w,touch:d,placement:_}=l,y={popper:["popper",!h&&"popperInteractive",w&&"popperArrow"],tooltip:["tooltip",w&&"tooltipArrow",d&&"touch",`tooltipPlacement${it(_.split("-")[0])}`],arrow:["arrow"]};return Et(y,Zt,o)},aa=Le(lt,{name:"MuiTooltip",slot:"Popper",overridesResolver:(l,o)=>{const{ownerState:h}=l;return[o.popper,!h.disableInteractive&&o.popperInteractive,h.arrow&&o.popperArrow,!h.open&&o.popperClose]}})(Fe(({theme:l})=>({zIndex:(l.vars||l).zIndex.tooltip,pointerEvents:"none",variants:[{props:({ownerState:o})=>!o.disableInteractive,style:{pointerEvents:"auto"}},{props:({open:o})=>!o,style:{pointerEvents:"none"}},{props:({ownerState:o})=>o.arrow,style:{[`&[data-popper-placement*="bottom"] .${D.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${D.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${D.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}},[`&[data-popper-placement*="left"] .${D.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}}}},{props:({ownerState:o})=>o.arrow&&!o.isRtl,style:{[`&[data-popper-placement*="right"] .${D.arrow}`]:{left:0,marginLeft:"-0.71em"}}},{props:({ownerState:o})=>o.arrow&&!!o.isRtl,style:{[`&[data-popper-placement*="right"] .${D.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:o})=>o.arrow&&!o.isRtl,style:{[`&[data-popper-placement*="left"] .${D.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:o})=>o.arrow&&!!o.isRtl,style:{[`&[data-popper-placement*="left"] .${D.arrow}`]:{left:0,marginLeft:"-0.71em"}}}]}))),na=Le("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(l,o)=>{const{ownerState:h}=l;return[o.tooltip,h.touch&&o.touch,h.arrow&&o.tooltipArrow,o[`tooltipPlacement${it(h.placement.split("-")[0])}`]]}})(Fe(({theme:l})=>({backgroundColor:l.vars?l.vars.palette.Tooltip.bg:ot(l.palette.grey[700],.92),borderRadius:(l.vars||l).shape.borderRadius,color:(l.vars||l).palette.common.white,fontFamily:l.typography.fontFamily,padding:"4px 8px",fontSize:l.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:l.typography.fontWeightMedium,[`.${D.popper}[data-popper-placement*="left"] &`]:{transformOrigin:"right center"},[`.${D.popper}[data-popper-placement*="right"] &`]:{transformOrigin:"left center"},[`.${D.popper}[data-popper-placement*="top"] &`]:{transformOrigin:"center bottom",marginBottom:"14px"},[`.${D.popper}[data-popper-placement*="bottom"] &`]:{transformOrigin:"center top",marginTop:"14px"},variants:[{props:({ownerState:o})=>o.arrow,style:{position:"relative",margin:0}},{props:({ownerState:o})=>o.touch,style:{padding:"8px 16px",fontSize:l.typography.pxToRem(14),lineHeight:`${ea(16/14)}em`,fontWeight:l.typography.fontWeightRegular}},{props:({ownerState:o})=>!o.isRtl,style:{[`.${D.popper}[data-popper-placement*="left"] &`]:{marginRight:"14px"},[`.${D.popper}[data-popper-placement*="right"] &`]:{marginLeft:"14px"}}},{props:({ownerState:o})=>!o.isRtl&&o.touch,style:{[`.${D.popper}[data-popper-placement*="left"] &`]:{marginRight:"24px"},[`.${D.popper}[data-popper-placement*="right"] &`]:{marginLeft:"24px"}}},{props:({ownerState:o})=>!!o.isRtl,style:{[`.${D.popper}[data-popper-placement*="left"] &`]:{marginLeft:"14px"},[`.${D.popper}[data-popper-placement*="right"] &`]:{marginRight:"14px"}}},{props:({ownerState:o})=>!!o.isRtl&&o.touch,style:{[`.${D.popper}[data-popper-placement*="left"] &`]:{marginLeft:"24px"},[`.${D.popper}[data-popper-placement*="right"] &`]:{marginRight:"24px"}}},{props:({ownerState:o})=>o.touch,style:{[`.${D.popper}[data-popper-placement*="top"] &`]:{marginBottom:"24px"}}},{props:({ownerState:o})=>o.touch,style:{[`.${D.popper}[data-popper-placement*="bottom"] &`]:{marginTop:"24px"}}}]}))),ra=Le("span",{name:"MuiTooltip",slot:"Arrow",overridesResolver:(l,o)=>o.arrow})(Fe(({theme:l})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:l.vars?l.vars.palette.Tooltip.bg:ot(l.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}})));let De=!1;const st=new kt;let xe={x:0,y:0};function Oe(l,o){return(h,...w)=>{o&&o(h,...w),l(h,...w)}}const m=i.forwardRef(function(o,h){const w=Pt({props:o,name:"MuiTooltip"}),{arrow:d=!1,children:_,classes:y,components:F={},componentsProps:$={},describeChild:b=!1,disableFocusListener:C=!1,disableHoverListener:p=!1,disableInteractive:W=!1,disableTouchListener:v=!1,enterDelay:n=100,enterNextDelay:O=0,enterTouchDelay:P=700,followCursor:M=!1,id:f,leaveDelay:B=0,leaveTouchDelay:k=1500,onClose:z,onOpen:N,open:a,placement:t="bottom",PopperComponent:r,PopperProps:u={},slotProps:x={},slots:A={},title:T,TransitionComponent:E,TransitionProps:I,...J}=w,Y=i.isValidElement(_)?_:e.jsx("span",{children:_}),ye=Tt(),Me=Rt(),[c,S]=i.useState(),[G,Q]=i.useState(null),Z=i.useRef(!1),pe=W||M,be=Pe(),Ae=Pe(),ve=Pe(),We=Pe(),[ct,Be]=Dt({controlled:a,default:!1,name:"Tooltip",state:"open"});let X=ct;const ke=Ot(f),ge=i.useRef(),we=Ve(()=>{ge.current!==void 0&&(document.body.style.WebkitUserSelect=ge.current,ge.current=void 0),We.clear()});i.useEffect(()=>we,[we]);const ze=g=>{st.clear(),De=!0,Be(!0),N&&!X&&N(g)},_e=Ve(g=>{st.start(800+B,()=>{De=!1}),Be(!1),z&&X&&z(g),be.start(ye.transitions.duration.shortest,()=>{Z.current=!1})}),Se=g=>{Z.current&&g.type!=="touchstart"||(c&&c.removeAttribute("title"),Ae.clear(),ve.clear(),n||De&&O?Ae.start(De?O:n,()=>{ze(g)}):ze(g))},Ee=g=>{Ae.clear(),ve.start(B,()=>{_e(g)})},[,Ge]=i.useState(!1),Ue=g=>{Ye(g.target)||(Ge(!1),Ee(g))},Qe=g=>{c||S(g.currentTarget),Ye(g.target)&&(Ge(!0),Se(g))},He=g=>{Z.current=!0;const V=Y.props;V.onTouchStart&&V.onTouchStart(g)},dt=g=>{He(g),ve.clear(),be.clear(),we(),ge.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",We.start(P,()=>{document.body.style.WebkitUserSelect=ge.current,Se(g)})},ut=g=>{Y.props.onTouchEnd&&Y.props.onTouchEnd(g),we(),ve.start(k,()=>{_e(g)})};i.useEffect(()=>{if(!X)return;function g(V){V.key==="Escape"&&_e(V)}return document.addEventListener("keydown",g),()=>{document.removeEventListener("keydown",g)}},[_e,X]);const ht=Mt(At(Y),S,h);!T&&T!==0&&(X=!1);const Ie=i.useRef(),pt=g=>{const V=Y.props;V.onMouseMove&&V.onMouseMove(g),xe={x:g.clientX,y:g.clientY},Ie.current&&Ie.current.update()},me={},$e=typeof T=="string";b?(me.title=!X&&$e&&!p?T:null,me["aria-describedby"]=X?ke:null):(me["aria-label"]=$e?T:null,me["aria-labelledby"]=X&&!$e?ke:null);const H={...me,...J,...Y.props,className:Je(J.className,Y.props.className),onTouchStart:He,ref:ht,...M?{onMouseMove:pt}:{}},fe={};v||(H.onTouchStart=dt,H.onTouchEnd=ut),p||(H.onMouseOver=Oe(Se,H.onMouseOver),H.onMouseLeave=Oe(Ee,H.onMouseLeave),pe||(fe.onMouseOver=Se,fe.onMouseLeave=Ee)),C||(H.onFocus=Oe(Qe,H.onFocus),H.onBlur=Oe(Ue,H.onBlur),pe||(fe.onFocus=Qe,fe.onBlur=Ue));const ee={...w,isRtl:Me,arrow:d,disableInteractive:pe,placement:t,PopperComponentProp:r,touch:Z.current},q=typeof x.popper=="function"?x.popper(ee):x.popper,gt=i.useMemo(()=>{var V,qe;let g=[{name:"arrow",enabled:!!G,options:{element:G,padding:4}}];return(V=u.popperOptions)!=null&&V.modifiers&&(g=g.concat(u.popperOptions.modifiers)),(qe=q==null?void 0:q.popperOptions)!=null&&qe.modifiers&&(g=g.concat(q.popperOptions.modifiers)),{...u.popperOptions,...q==null?void 0:q.popperOptions,modifiers:g}},[G,u.popperOptions,q==null?void 0:q.popperOptions]),Ne=ta(ee),mt=typeof x.transition=="function"?x.transition(ee):x.transition,Ce={slots:{popper:F.Popper,transition:F.Transition??E,tooltip:F.Tooltip,arrow:F.Arrow,...A},slotProps:{arrow:x.arrow??$.arrow,popper:{...u,...q??$.popper},tooltip:x.tooltip??$.tooltip,transition:{...I,...mt??$.transition}}},[ft,xt]=Te("popper",{elementType:aa,externalForwardedProps:Ce,ownerState:ee,className:Je(Ne.popper,u==null?void 0:u.className)}),[jt,yt]=Te("transition",{elementType:Xt,externalForwardedProps:Ce,ownerState:ee}),[bt,vt]=Te("tooltip",{elementType:na,className:Ne.tooltip,externalForwardedProps:Ce,ownerState:ee}),[wt,_t]=Te("arrow",{elementType:ra,className:Ne.arrow,externalForwardedProps:Ce,ownerState:ee,ref:Q});return e.jsxs(i.Fragment,{children:[i.cloneElement(Y,H),e.jsx(ft,{as:r??lt,placement:t,anchorEl:M?{getBoundingClientRect:()=>({top:xe.y,left:xe.x,right:xe.x,bottom:xe.y,width:0,height:0})}:c,popperRef:Ie,open:c?X:!1,id:ke,transition:!0,...fe,...xt,popperOptions:gt,children:({TransitionProps:g})=>e.jsx(jt,{timeout:ye.transitions.duration.shorter,...g,...yt,children:e.jsxs(bt,{...vt,children:[T,d?e.jsx(wt,{..._t}):null]})})})]})}),sa=({ordinances:l})=>{const o=()=>{const h=window.open("","_blank");h.document.write(`
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Records Summary</title>
	<style>
		body {
			font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
			padding: 30px;
			background-color: #f4f6fa;
			color: #2c3e50;
			line-height: 1.6;
		}

		h2 {
			text-align: center;
			margin-bottom: 30px;
			color: #34495e;
			font-size: 28px;
			letter-spacing: 1px;
		}

		ol {
			padding-left: 0;
			list-style: none;
			max-width: 800px;
			margin: 0 auto;
		}

		.summary-item {
			background: #ffffff;
			padding: 20px;
			margin-bottom: 15px;
			border-left: 6px solid #3498db;
			border-radius: 8px;
			box-shadow: 0 2px 5px rgba(0,0,0,0.05);
			transition: background 0.3s ease-in-out;
		}

		.summary-item:hover {
			background: #f9fbfd;
		}

		.summary-item strong {
			color: #2c3e50;
			font-weight: 600;
		}

		.print-btn, .scroll-btn {
			display: block;
			width: 180px;
			margin: 10px auto;
			padding: 12px 20px;
			text-align: center;
			background: #3498db;
			color: #fff;
			border: none;
			border-radius: 6px;
			cursor: pointer;
			font-size: 16px;
			font-weight: bold;
			box-shadow: 0 2px 5px rgba(0,0,0,0.1);
			transition: background 0.3s;
		}

		.print-btn:hover, .scroll-btn:hover {
			background: #2980b9;
		}

		.scroll-btn {
			position: fixed;
			bottom: 10px;
			right: 30px;
			width: 60px;
            height:60px;
			padding: 10px 14px;
			border-radius: 50%;
			font-size: 18px;
			box-shadow: 0 4px 10px rgba(0,0,0,0.15);
		}

		@media print {
			.print-btn, .scroll-btn { display: none; }
			body {
				background: #fff;
				padding: 0;
				color: #000;
			}
			.summary-item {
				page-break-inside: avoid;
				border-left-color: #000;
				box-shadow: none;
			}
		}
	</style>
</head>
<body>

	<div class="summary-container">
		<h2>Records Summary</h2>
		<ol>
			${l.map(w=>`
				<li class="summary-item">
					<strong>Title:</strong> ${w.title} <br/>
					<strong>Type:</strong> ${w.document_type} <br/>
					<strong>Date Issued:</strong> ${new Intl.DateTimeFormat("en-US",{dateStyle:"medium"}).format(new Date(w.date_issued))}
				</li>`).join("")}
		</ol>

		<!-- Buttons -->
		<button class="print-btn" onclick="window.print();">Print Summary</button>
		<button class="scroll-btn" onclick="window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });">&#8595;</button>
	</div>

</body>
</html>
	`),h.document.close()};return e.jsx(R,{onClick:o,style:{marginTop:"10px",padding:"10px",backgroundColor:"#6200ea",color:"white",border:"none",cursor:"pointer",borderRadius:"5px"},children:"Print Summary"})};function ia(){const[l,o]=i.useState([]),[h,w]=i.useState(!1),[d,_]=i.useState(null),[y,F]=i.useState(""),[$,b]=i.useState([]),[C,p]=i.useState(0),[W,v]=i.useState(10),[n,O]=i.useState(!1),[P,M]=i.useState(10),[f,B]=i.useState(""),[k,z]=i.useState(""),[N,a]=i.useState(f),[t,r]=i.useState({open:!1,message:"",severity:"info"}),[u,x]=i.useState({title:!0,status:!0,details:!0,document_type:!0,date_issued:!0,number:!0,file_path:!1,date_effectivity:!0});i.useEffect(()=>{const c=setTimeout(()=>{a(f),f.trim()===""?v(10):v(P)},400);return()=>clearTimeout(c)},[f,P]);const A=async()=>{const c={};for(let S in d)u[S]&&(c[S]=d[S]);try{await Lt(d.id,c),console.log("Ordinance updated successfully."),r({open:!0,message:"Record Updated Successfully",severity:"success"}),w(!1),await T()}catch(S){console.error("Failed to update ordinance:",S)}},T=async()=>{try{const c=await $t(C+1,W,N,k);c.ordinances.length===0?(r({message:"No Records found.",severity:"error"}),o([]),b([])):(o(c.ordinances),b(c.ordinances),M(c.total_count)),M(c.total_count)}catch{r({message:"An error occurred while fetching ordinances.",severity:"error"})}};i.useEffect(()=>{T()},[C,W,N,k]),i.useEffect(()=>{const c=S=>{if(!S)return"";const G=new Date(S);return isNaN(G)?S:`${G.getFullYear()}-${G.getMonth()+1}-${G.getDate()}`};if(l&&l.length>0){const S=N.trim().toLowerCase(),G=l.filter(Q=>{const Z=c(Q.date_issued).toLowerCase(),pe=Q.title&&Q.title.toLowerCase().includes(S)||Q.document_type&&Q.document_type.toLowerCase().includes(S)||Q.status&&Q.status.toLowerCase().includes(S)||Q.number&&Q.number.toLowerCase().includes(S)||Z&&Z.includes(S),be=!k||Q.document_type===k;return pe&&be});b(G)}else b([])},[N,k,l]);const E=(c,S)=>{p(S)},I=c=>{v(parseInt(c.target.value,10)),p(0)},J=async c=>{if(window.confirm("Are you sure you want to delete this record?"))try{await Nt(c),o(S=>S.filter(G=>G.id!==c)),b(S=>S.filter(G=>G.id!==c)),r({message:"Record deleted successfully.",severity:"success"})}catch(S){console.error("Error deleting record:",S),r({message:"An error occurred while deleting the record.",severity:"error"})}},Y=c=>{z(c.target.value)},ye=c=>{B(c.target.value)},Me=["All","Ordinance","Executive Order","Memo","Resolution"];return e.jsxs("div",{children:[e.jsxs(K,{display:"flex",justifyContent:"space-between",alignItems:"center",gap:2,flexWrap:"wrap",children:[e.jsxs(K,{children:[e.jsx(j,{label:"Search Record",variant:"outlined",margin:"normal",sx:{marginRight:1},value:f,onChange:ye}),e.jsxs(at,{variant:"outlined",margin:"normal",sx:{minWidth:200},children:[e.jsx(nt,{children:"Document Type"}),e.jsx(rt,{value:k,onChange:Y,label:"Document Type",children:Me.map((c,S)=>e.jsx(U,{value:c==="All"?"":c,children:c},S))})]})]}),e.jsx(K,{children:e.jsx(sa,{onClick:()=>{v(P)},ordinances:$})})]}),e.jsx(ie,{children:e.jsxs(oe,{children:[e.jsx(le,{children:e.jsxs(L,{children:[e.jsx(s,{children:"Title"}),e.jsx(s,{children:"Status"}),e.jsx(s,{children:"Series No."}),e.jsx(s,{children:"Document Type"}),e.jsx(s,{children:"Date Issued"}),e.jsx(s,{children:"Actions"})]})}),e.jsx(ce,{children:$.map(c=>e.jsxs(L,{children:[e.jsx(m,{title:c.title,arrow:!0,placement:"top-start",children:e.jsx(s,{children:c.title})}),e.jsx(m,{title:c.status,arrow:!0,placement:"top-start",children:e.jsx(s,{children:c.status})}),e.jsx(m,{title:c.number,arrow:!0,placement:"top-start",children:e.jsx(s,{children:c.number})}),e.jsx(m,{title:c.document_type,arrow:!0,placement:"top-start",children:e.jsx(s,{children:c.document_type})}),e.jsx(m,{title:new Date(c.date_issued).toLocaleDateString(),arrow:!0,placement:"top-start",children:e.jsx(s,{children:new Date(c.date_issued).toLocaleDateString()})}),e.jsxs(s,{children:[c.file_path&&e.jsx(Re,{onClick:()=>It(c.file_path,F,O),children:e.jsx("img",{src:"/Printer.svg",alt:"preview"})}),e.jsx(Re,{onClick:()=>J(c.id),color:"error",children:e.jsx("img",{src:"/trash.svg",alt:"delete"})}),e.jsx(Re,{onClick:()=>{_(c),w(!0)},color:"primary",children:e.jsx("img",{src:"/edit.svg",alt:"edit"})})]})]},c.id))})]})}),e.jsx(K,{sx:{display:"flex",justifyContent:"flex-end"},children:typeof P=="number"&&P>0&&e.jsx(se,{component:"div",count:P,page:C,onPageChange:E,rowsPerPage:W,onRowsPerPageChange:I,rowsPerPageOptions:[10,25,50,100,P]})}),e.jsx(de,{open:!!t.message,autoHideDuration:4e3,onClose:()=>r({open:!1,message:"",severity:"info"}),children:e.jsx(ue,{onClose:()=>r({open:!1,message:"",severity:"info"}),severity:t.severity||"info",sx:{width:"100%"},children:t.message})}),e.jsxs(te,{open:n,onClose:()=>O(!1),children:[e.jsxs(ae,{children:["Preview Records",e.jsx(Re,{onClick:()=>O(!1),style:{float:"right"},children:e.jsx(Kt,{})})]}),e.jsx(ne,{dividers:!0,children:y?e.jsx("iframe",{src:y,width:"100%",height:"600px",title:"Ordinance Preview",style:{border:"none"}}):e.jsx("p",{children:"No file selected."})})]}),e.jsxs(te,{open:h,onClose:()=>w(!1),children:[e.jsx(ae,{children:"Edit Ordinance"}),e.jsxs(ne,{children:[e.jsx(j,{label:"Title",fullWidth:!0,margin:"dense",value:(d==null?void 0:d.title)||"",onChange:c=>_({...d,title:c.target.value})}),e.jsxs(at,{fullWidth:!0,children:[e.jsx(nt,{children:"Status"}),e.jsxs(rt,{label:"Status",margin:"dense",value:(d==null?void 0:d.status)||"",onChange:c=>_({...d,status:c.target.value}),children:[e.jsx(U,{value:"Approved",children:"Approved"}),e.jsx(U,{value:"Pending",children:"Pending"}),e.jsx(U,{value:"Amended",children:"Amended"}),e.jsx(U,{value:"Under Review",children:"Under Review"}),e.jsx(U,{value:"Implemented",children:"Implemented"})]})]}),e.jsx(j,{label:"Details",fullWidth:!0,margin:"dense",value:(d==null?void 0:d.details)||"",onChange:c=>_({...d,details:c.target.value})}),e.jsx(j,{label:"Series No.",fullWidth:!0,margin:"dense",value:(d==null?void 0:d.number)||"",onChange:c=>_({...d,number:c.target.value})}),e.jsx(j,{label:"Document Type",fullWidth:!0,margin:"dense",value:(d==null?void 0:d.document_type)||"",onChange:c=>_({...d,document_type:c.target.value})}),e.jsx(j,{label:"Date Issued",type:"date",fullWidth:!0,margin:"dense",value:d!=null&&d.date_issued?new Date(d.date_issued).toISOString().split("T")[0]:"",onChange:c=>_({...d,date_issued:c.target.value}),InputLabelProps:{shrink:!0}})]}),e.jsxs(he,{children:[e.jsx(R,{onClick:()=>w(!1),children:"Cancel"}),e.jsx(R,{onClick:()=>A(),variant:"contained",color:"primary",children:"Save"})]})]})]})}function oa(){const[l,o]=i.useState([]),[h,w]=i.useState(""),[d,_]=i.useState(0),[y,F]=i.useState(10),[$,b]=i.useState(!0),[C,p]=i.useState({open:!1,message:"",severity:"info"}),[W,v]=i.useState(!1),[n,O]=i.useState(null);i.useEffect(()=>{(async()=>{try{const r=await Ke();r.length===0?p({open:!0,message:"No Record Found.",severity:"error"}):(p({open:!0,message:"Records fetched Successfully.",severity:"success"}),o(r))}catch{p({open:!0,message:"Error fetching Records.",severity:"error"})}finally{b(!1)}})()},[]);const P=i.useMemo(()=>l.filter(t=>{var A,T,E;const r=h.toLowerCase(),u=((A=t.title)==null?void 0:A.toLowerCase().includes(r))||((T=t.number)==null?void 0:T.toString().toLowerCase().includes(r)),x=(E=t.coverage_scopes)==null?void 0:E.some(I=>["target_beneficiaries","geographical_coverage","inclusive_period"].some(J=>I[J]&&I[J].toLowerCase().includes(r)));return u||x}),[l,h]),M=(t,r)=>{O({id:(r==null?void 0:r.id)||"",ordinance_id:t.id,inclusive_period:(r==null?void 0:r.inclusive_period)||"",target_beneficiaries:(r==null?void 0:r.target_beneficiaries)||"",geographical_coverage:(r==null?void 0:r.geographical_coverage)||""}),v(!0)},f=t=>{O({...n,[t.target.name]:t.target.value})},B=async()=>{try{n.id?(await Ft(n.id,n),alert("Record updated successfully!")):(await Wt(n),alert("Record added successfully!")),v(!1),b(!0);const t=await Ke();o(t),b(!1)}catch(t){p({open:!0,message:"Failed to save Record. Please try again.",severity:"error"}),console.error("Error saving Record:",t)}},k=t=>w(t.target.value),z=(t,r)=>_(r),N=t=>{F(parseInt(t.target.value,10)),_(0)};if($)return e.jsx(K,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"60vh",children:e.jsx(je,{})});const a=["City-Wide","Alicaocao","Alinam","Amobocan","Andarayan","Baculod","Baringin Norte","Baringin Sur","Buena Suerte","Bugallon","Buyon","Cabaruan","Cabugao","Carabatan Bacareno","Carabatan Chica","Carabatan Grande","Carabatan Punta","Casalatan","Cassap Fuera","Catalina","Culalabat","Dabburab","De Vera","Dianao","Dissimuray","District I (Poblacion)","District II (Poblacion)","District III (Poblacion)","Duminit","Faustino (Sipay)","Gagabutan","Gappal","Guayabal","Labinab","Linglingay","Mabantad","Maligaya","Manaoag","Marabulig I","Marabulig II","Minante I","Minante II","Nagcampegan","Naganacan","Nagrumbuan","Nungnungan I","Nungnungan II","Pinoma","Rizal","Rizaluna","Rogus","San Antonio","San Fermin (Poblacion)","San Francisco","San Isidro","San Luis","San Pablo (Casap Hacienda)","Santa Luciana (Daburab 2)","Santa Maria","Sillawit","Sinippil","Tagaran","Turayong","Union","Villa Concepcion","Villa Luna","Villaflor"];return console.log(P),e.jsxs("div",{children:[e.jsx(j,{label:"Search Record",variant:"outlined",margin:"normal",value:h,onChange:k}),e.jsx(ie,{children:e.jsxs(oe,{children:[e.jsx(le,{children:e.jsxs(L,{children:[e.jsx(s,{children:"Title"}),e.jsx(s,{children:"Inclusive Period"}),e.jsx(s,{children:"Target Beneficiaries"}),e.jsx(s,{children:"Geographical Coverage"}),e.jsx(s,{children:"Actions"})]})}),e.jsx(ce,{children:P.slice(d*y,d*y+y).flatMap(t=>t.coverage_scopes.length>0?t.coverage_scopes.map(r=>e.jsxs(L,{children:[e.jsx(m,{title:`${t.title}  ${t.number}`,arrow:!0,placement:"top-start",children:e.jsxs(s,{children:[t.title," ",t.number,console.log(t)]})}),e.jsx(m,{title:r.inclusive_period,arrow:!0,placement:"top-start",children:e.jsx(s,{children:r.inclusive_period||"No coverage scope added"})}),e.jsx(m,{arrow:!0,title:r.target_beneficiaries,placement:"top-start",children:e.jsx(s,{children:r.target_beneficiaries})}),e.jsx(m,{arrow:!0,placement:"top-start",title:r.geographical_coverage,children:e.jsx(s,{children:r.geographical_coverage})}),e.jsx(s,{children:e.jsx(R,{variant:"outlined",onClick:()=>M(t,r),children:"Edit"})})]},`${t.id}-${r.id}`)):e.jsxs(L,{children:[e.jsx(m,{title:`${t.title}  ${t.number}`,arrow:!0,placement:"top-start",children:e.jsxs(s,{children:[t.title," ",t.number]})}),e.jsx(s,{colSpan:3,children:"No record"}),e.jsx(s,{children:e.jsx(R,{variant:"contained",onClick:()=>M(t,null),children:"Add"})})]},t.id))})]})}),e.jsx(K,{sx:{display:"flex",justifyContent:"flex-end"},children:e.jsx(se,{rowsPerPageOptions:[10,20,100],component:"div",count:P.length,rowsPerPage:y,page:d,onPageChange:z,onRowsPerPageChange:N})}),e.jsxs(te,{open:W,onClose:()=>v(!1),children:[e.jsxs(ae,{children:[n!=null&&n.id?"Edit":"Add"," Coverage Scope"]}),e.jsxs(ne,{children:[e.jsx(j,{label:"Inclusive Period",name:"inclusive_period",value:(n==null?void 0:n.inclusive_period)||"",onChange:f,fullWidth:!0,margin:"normal"}),e.jsx(j,{label:"Target Beneficiaries",name:"target_beneficiaries",value:(n==null?void 0:n.target_beneficiaries)||"General Public",onChange:f,select:!0,fullWidth:!0,margin:"normal",children:["General Public","Women","Children","Solo Parents","PWDs","MSMEs","Others"].map(t=>e.jsx(U,{value:t,children:t},t))}),e.jsx(j,{label:"Geographical Coverage",name:"geographical_coverage",value:(n==null?void 0:n.geographical_coverage)||"",onChange:f,fullWidth:!0,select:!0,margin:"normal",children:a.map(t=>e.jsx(U,{value:t,children:t},t))})]}),e.jsxs(he,{children:[e.jsx(R,{onClick:()=>v(!1),children:"Cancel"}),e.jsx(R,{variant:"contained",onClick:B,children:"Save"})]})]}),e.jsx(de,{open:C.open,autoHideDuration:4e3,onClose:()=>p({open:!1,message:"",severity:"info"}),children:e.jsx(ue,{onClose:()=>p({open:!1,message:"",severity:"info"}),severity:C.severity,sx:{width:"100%"},children:C.message})})]})}function la(){const[l,o]=i.useState([]),[h,w]=i.useState(""),[d,_]=i.useState(0),[y,F]=i.useState(10),[$,b]=i.useState(!0),[C,p]=i.useState({open:!1,message:"",severity:"info"}),[W,v]=i.useState(!1),[n,O]=i.useState(null);i.useEffect(()=>{var r;const a=localStorage.getItem("ObjectivesRecords");if(a){const u=JSON.parse(a),x=Date.now()-u.cachedAt>1e3*60*5;if(((r=u.ordinances)==null?void 0:r.length)>0&&!x){o(u.ordinances),b(!1);return}}(async()=>{try{const u=await Xe();u.length===0?p({open:!0,message:"No Record Found.",severity:"error"}):(p({open:!0,message:"Records fetched Successfully.",severity:"success"}),o(u))}catch{p({open:!0,message:"Error fetching Records.",severity:"error"})}finally{b(!1)}})()},[d,y]),i.useEffect(()=>{localStorage.setItem("ObjectivesRecords",JSON.stringify({ordinances:l,cachedAt:Date.now()}))},[l]);const P=i.useMemo(()=>l.filter(a=>{var x,A,T;const t=h.toLowerCase(),r=((x=a.title)==null?void 0:x.toLowerCase().includes(t))||((A=a.number)==null?void 0:A.toString().toLowerCase().includes(t)),u=(T=a.objectives_implementation)==null?void 0:T.some(E=>["lead_agency","supporting_agencies","policy_objectives","key_provisions","programs_activities"].some(I=>E[I]&&E[I].toLowerCase().includes(t)));return r||u}),[l,h]),M=(a,t)=>{O({id:(t==null?void 0:t.id)||"",ordinance_id:a.id,policy_objectives:(t==null?void 0:t.policy_objectives)||"",lead_agency:(t==null?void 0:t.lead_agency)||"",supporting_agencies:(t==null?void 0:t.supporting_agencies)||"",key_provisions:(t==null?void 0:t.key_provisions)||"",programs_activities:(t==null?void 0:t.programs_activities)||""}),v(!0)},f=a=>{O({...n,[a.target.name]:a.target.value})},B=async()=>{try{n.id?(await Bt(n.id,n),alert("Coverage scope updated successfully!")):(await zt(n),alert("Coverage scope added successfully!")),v(!1),b(!0);const a=await Xe(),t={ordinances:a,cachedAt:Date.now()};localStorage.setItem("ObjectivesRecords",JSON.stringify(t)),o(a),b(!1)}catch(a){p({open:!0,message:"Failed to save coverage scope. Please try again.",severity:"error"}),console.error("Error saving coverage scope:",a)}},k=a=>w(a.target.value),z=(a,t)=>_(t),N=a=>{F(parseInt(a.target.value,10)),_(0)};return $?e.jsx(je,{}):e.jsxs("div",{children:[e.jsx(j,{label:"Search Record",variant:"outlined",margin:"normal",value:h,onChange:k}),e.jsx(ie,{children:e.jsxs(oe,{children:[e.jsx(le,{children:e.jsxs(L,{children:[e.jsx(s,{children:"Title"}),e.jsx(s,{children:"Policy Objectives"}),e.jsx(s,{children:"Lead Agency"}),e.jsx(s,{children:"Supporting Agencies"}),e.jsx(s,{children:"Key Provisions"}),e.jsx(s,{children:"Programs/Activities"}),e.jsx(s,{children:"Actions"})]})}),e.jsx(ce,{children:P.slice(d*y,d*y+y).flatMap(a=>a.objectives_implementation.length>0?a.objectives_implementation.map(t=>e.jsxs(L,{children:[e.jsx(s,{children:e.jsxs(m,{title:`${a.title} ${a.number}`,arrow:!0,placement:"top-start",children:[a.title," ",a.number]})}),e.jsx(s,{children:e.jsx(m,{title:t.policy_objectives,arrow:!0,placement:"top-start",children:e.jsx("span",{children:t.policy_objectives})})}),e.jsx(s,{children:e.jsx(m,{title:t.lead_agency,arrow:!0,placement:"top-start",children:e.jsx("span",{children:t.lead_agency})})}),e.jsx(s,{children:e.jsx(m,{title:t.supporting_agencies,arrow:!0,placement:"top-start",children:e.jsx("span",{children:t.supporting_agencies})})}),e.jsx(s,{children:e.jsx(m,{title:t.key_provisions,arrow:!0,placement:"top-start",children:e.jsx("span",{children:t.key_provisions})})}),e.jsx(s,{children:e.jsx(m,{title:t.programs_activities||"No Programs/Activities Data",arrow:!0,placement:"top-start",children:e.jsx("span",{children:t.programs_activities})})}),e.jsx(s,{children:e.jsx(R,{variant:"outlined",onClick:()=>M(a,t),children:"Edit"})})]},`${a.id}-${t.id}`)):e.jsxs(L,{children:[e.jsx(s,{children:e.jsx(m,{title:`${a.title} ${a.number}`,arrow:!0,placement:"top-start",children:e.jsxs("span",{children:[a.title," ",a.number]})})}),e.jsx(s,{colSpan:5,children:"No Objectives/Implementation"}),e.jsx(s,{children:e.jsx(R,{variant:"contained",onClick:()=>M(a,null),children:"Add"})})]},a.id))})]})}),e.jsx(K,{sx:{display:"flex",justifyContent:"flex-end"},children:e.jsx(se,{rowsPerPageOptions:[10,20,100],component:"div",count:P.length,rowsPerPage:y,page:d,onPageChange:z,onRowsPerPageChange:N})}),e.jsxs(te,{open:W,onClose:()=>v(!1),children:[e.jsxs(ae,{children:[n!=null&&n.id?"Edit":"Add"," Coverage Scope"]}),e.jsxs(ne,{children:[e.jsx(j,{label:"Policy Objectives",name:"policy_objectives",value:(n==null?void 0:n.policy_objectives)||"",onChange:f,fullWidth:!0,margin:"normal"}),e.jsx(j,{label:"Lead Agency ",name:"lead_agency",value:(n==null?void 0:n.lead_agency)||"",onChange:f,fullWidth:!0,margin:"normal"}),e.jsx(j,{label:"Supporting Agencies",name:"supporting_agencies",value:(n==null?void 0:n.supporting_agencies)||"",onChange:f,fullWidth:!0,margin:"normal"}),e.jsx(j,{label:"Key Provisions",name:"key_provisions",value:(n==null?void 0:n.key_provisions)||"",onChange:f,fullWidth:!0,margin:"normal"}),e.jsx(j,{label:"Programs Activities",name:"programs_activities",value:(n==null?void 0:n.programs_activities)||"",onChange:f,fullWidth:!0,margin:"normal"})]}),e.jsxs(he,{children:[e.jsx(R,{onClick:()=>v(!1),children:"Cancel"}),e.jsx(R,{variant:"contained",onClick:B,children:"Save"})]})]}),e.jsx(de,{open:C.open,autoHideDuration:4e3,onClose:()=>p({open:!1,message:"",severity:"info"}),children:e.jsx(ue,{onClose:()=>p({open:!1,message:"",severity:"info"}),severity:C.severity,sx:{width:"100%"},children:C.message})})]})}function ca(){const[l,o]=i.useState([]),[h,w]=i.useState(""),[d,_]=i.useState(0),[y,F]=i.useState(10),[$,b]=i.useState(!0),[C,p]=i.useState({open:!1,message:"",severity:"info"}),[W,v]=i.useState(!1),[n,O]=i.useState(null);i.useEffect(()=>{var u;const t=localStorage.getItem("BudgetRecords");if(t){const x=JSON.parse(t),A=Date.now()-x.cachedAt>1e3*60*5;if(((u=x.ordinances)==null?void 0:u.length)>0&&!A){o(x.ordinances),b(!1);return}}(async()=>{try{const x=await Ze();x.length===0?p({open:!0,message:"No Record Found.",severity:"error"}):(p({open:!0,message:"Records fetched Successfully.",severity:"success"}),o(x))}catch{p({open:!0,message:"Error fetching Records.",severity:"error"})}finally{b(!1)}})()},[d,y]),i.useEffect(()=>{localStorage.setItem("BudgetRecords",JSON.stringify({ordinances:l,cachedAt:Date.now()}))},[l]);const P=i.useMemo(()=>l.filter(t=>{var A,T,E;const r=h.toLowerCase(),u=((A=t.title)==null?void 0:A.toLowerCase().includes(r))||((T=t.number)==null?void 0:T.toString().toLowerCase().includes(r)),x=(E=t.budget_allocation)==null?void 0:E.some(I=>["allocated_budget","utilized_budget","gad_budget","financial_transparency_measures"].some(J=>I[J]&&I[J].toLowerCase().includes(r)));return u||x}),[l,h]),M=(t,r)=>{O({id:(r==null?void 0:r.id)||"",ordinance_id:t.id,allocated_budget:(r==null?void 0:r.allocated_budget)||"",utilized_budget:(r==null?void 0:r.utilized_budget)||"",gad_budget:(r==null?void 0:r.gad_budget)||"",financial_transparency_measures:(r==null?void 0:r.financial_transparency_measures)||""}),v(!0)},f=t=>{O({...n,[t.target.name]:t.target.value})},B=async()=>{try{n.id?(await Gt(n.id,n),alert("Record updated successfully!")):(await Ut(n),alert("Record added successfully!")),v(!1),b(!0);const t=await Ze(),r={ordinances:t,cachedAt:Date.now()};localStorage.setItem("BudgetRecords",JSON.stringify(r)),o(t),b(!1)}catch(t){p({open:!0,message:"Failed to save Record. Please try again.",severity:"error"}),console.error("Error saving Record:",t)}},k=t=>w(t.target.value),z=(t,r)=>_(r),N=t=>{F(parseInt(t.target.value,10)),_(0)};if($)return e.jsx(je,{});const a=t=>!t||isNaN(t)?"₱0.00":new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:2}).format(t);return e.jsxs("div",{children:[e.jsx(j,{label:"Search Record",variant:"outlined",margin:"normal",value:h,onChange:k}),e.jsx(ie,{children:e.jsxs(oe,{children:[e.jsx(le,{children:e.jsxs(L,{children:[e.jsx(s,{children:"Title"}),e.jsx(s,{children:"Allocated Budget"}),e.jsx(s,{children:"Utilized Budget"}),e.jsx(s,{children:"GAD Budget"}),e.jsx(s,{children:"Financial Transparency Measures"}),e.jsx(s,{children:"Actions"})]})}),e.jsx(ce,{children:P.slice(d*y,d*y+y).flatMap(t=>t.budget_allocation.length>0?t.budget_allocation.map(r=>e.jsxs(L,{children:[e.jsx(s,{children:e.jsxs(m,{title:`${t.title} ${t.number}`,arrow:!0,children:[t.title," ",t.number]})}),e.jsx(s,{children:e.jsx(m,{title:`Allocated Budget: ${a(r.allocated_budget)}`,arrow:!0,children:e.jsx("span",{children:a(r.allocated_budget)})})}),e.jsx(s,{children:e.jsx(m,{title:`Utilized Budget: ${a(r.utilized_budget)}`,arrow:!0,children:e.jsx("span",{children:a(r.utilized_budget)})})}),e.jsx(s,{children:e.jsx(m,{title:`GAD Budget: ${a(r.gad_budget)}`,arrow:!0,children:e.jsx("span",{children:a(r.gad_budget)})})}),e.jsx(s,{children:e.jsx(m,{title:`Financial Transparency: ${r.financial_transparency_measures}`,arrow:!0,children:e.jsx("span",{children:r.financial_transparency_measures})})}),e.jsx(s,{children:e.jsx(R,{variant:"outlined",onClick:()=>M(t,r),children:"Edit"})})]},`${t.id}-${r.id}`)):e.jsxs(L,{children:[e.jsx(m,{title:`${t.title} ${t.number}`,arrow:!0,children:e.jsxs(s,{children:[t.title," ",t.number]})}),e.jsx(s,{colSpan:4,children:"No Budget Allocation Data"}),e.jsx(s,{children:e.jsx(R,{variant:"contained",onClick:()=>M(t,null),children:"Add"})})]},t.id))})]})}),e.jsx(K,{sx:{display:"flex",justifyContent:"flex-end"},children:e.jsx(se,{rowsPerPageOptions:[10,20,100],component:"div",count:P.length,rowsPerPage:y,page:d,onPageChange:z,onRowsPerPageChange:N})}),e.jsxs(te,{open:W,onClose:()=>v(!1),children:[e.jsxs(ae,{children:[n!=null&&n.id?"Edit":"Add"," Coverage Scope"]}),e.jsxs(ne,{children:[e.jsx(j,{label:"Allocated Budget",name:"allocated_budget",type:"number",value:(n==null?void 0:n.allocated_budget)||"",onChange:f,fullWidth:!0,margin:"normal"}),e.jsx(j,{label:"Utilized Budget",type:"number",name:"utilized_budget",value:(n==null?void 0:n.utilized_budget)||"",onChange:f,fullWidth:!0,margin:"normal"}),e.jsx(j,{label:"GAD Budget",type:"number",name:"gad_budget",value:(n==null?void 0:n.gad_budget)||"",onChange:f,fullWidth:!0,margin:"normal"}),e.jsx(j,{label:"Financial Transparency Measures",name:"financial_transparency_measures",value:(n==null?void 0:n.financial_transparency_measures)||"",onChange:f,fullWidth:!0,margin:"normal"})]}),e.jsxs(he,{children:[e.jsx(R,{onClick:()=>v(!1),children:"Cancel"}),e.jsx(R,{variant:"contained",onClick:B,children:"Save"})]})]}),e.jsx(de,{open:C.open,autoHideDuration:4e3,onClose:()=>p({open:!1,message:"",severity:"info"}),children:e.jsx(ue,{onClose:()=>p({open:!1,message:"",severity:"info"}),severity:C.severity,sx:{width:"100%"},children:C.message})})]})}function da(){const[l,o]=i.useState([]),[h,w]=i.useState(""),[d,_]=i.useState(0),[y,F]=i.useState(10),[$,b]=i.useState(!0),[C,p]=i.useState({open:!1,message:"",severity:"info"}),[W,v]=i.useState(!1),[n,O]=i.useState(null);i.useEffect(()=>{var r;const a=localStorage.getItem("MonitoringRecords");if(a){const u=JSON.parse(a),x=Date.now()-u.cachedAt>1e3*60*5;if(((r=u.ordinances)==null?void 0:r.length)>0&&!x){o(u.ordinances),b(!1);return}}(async()=>{try{const u=await et();u.length===0?p({open:!0,message:"No Record Found.",severity:"error"}):(p({open:!0,message:"Records fetched Successfully.",severity:"success"}),o(u))}catch{p({open:!0,message:"Error fetching Records.",severity:"error"})}finally{b(!1)}})()},[d,y]),i.useEffect(()=>{localStorage.setItem("MonitoringRecords",JSON.stringify({ordinances:l,cachedAt:Date.now()}))},[l]);const P=i.useMemo(()=>l.filter(a=>{var x,A,T;const t=h.toLowerCase(),r=((x=a.title)==null?void 0:x.toLowerCase().includes(t))||((A=a.number)==null?void 0:A.toString().toLowerCase().includes(t)),u=(T=a.coverage_scopes)==null?void 0:T.some(E=>["indicators_of_success","monitoring_frequency","compliance_rate","challenges","violations_reports","feedback_mechanisms"].some(I=>E[I]&&E[I].toLowerCase().includes(t)));return r||u}),[l,h]),M=(a,t)=>{O({id:(t==null?void 0:t.id)||"",ordinance_id:a.id,compliance_rate:(t==null?void 0:t.compliance_rate)||"0.00",indicators_of_success:(t==null?void 0:t.indicators_of_success)||"",monitoring_frequency:(t==null?void 0:t.monitoring_frequency)||"Monthly",challenges:(t==null?void 0:t.challenges)||"",violations_reports:(t==null?void 0:t.violations_reports)||"",feedback_mechanisms:(t==null?void 0:t.feedback_mechanisms)||""}),v(!0)},f=a=>{O({...n,[a.target.name]:a.target.value})},B=async()=>{try{n.id?(await Qt(n.id,n),alert("Record updated successfully!")):(await Ht(n),alert("Record added successfully!")),v(!1),b(!0);const a=await et(),t={ordinances:a,cachedAt:Date.now()};localStorage.setItem("MonitoringRecords",JSON.stringify(t)),o(a),b(!1)}catch(a){p({open:!0,message:"Failed to save Record. Please try again.",severity:"error"}),console.error("Error saving Record:",a)}},k=a=>w(a.target.value),z=(a,t)=>_(t),N=a=>{F(parseInt(a.target.value,10)),_(0)};return $?e.jsx(je,{}):e.jsxs("div",{children:[e.jsx(j,{label:"Search Record",variant:"outlined",margin:"normal",value:h,onChange:k}),e.jsx(ie,{children:e.jsxs(oe,{children:[e.jsx(le,{children:e.jsxs(L,{children:[e.jsx(s,{children:"Title"}),e.jsx(s,{children:"Indicators of Success"}),e.jsx(s,{children:"Frequency"}),e.jsx(s,{children:"Compliance Rate"}),e.jsx(s,{children:"Challenges"}),e.jsx(s,{children:"Violations"}),e.jsx(s,{children:"Feedback"}),e.jsx(s,{children:"Actions"})]})}),e.jsx(ce,{children:P.slice(d*y,d*y+y).flatMap(a=>a.monitoring_compliance.length>0?a.monitoring_compliance.map(t=>e.jsxs(L,{children:[e.jsx(s,{children:e.jsx(m,{title:`${a.title} ${a.number}`,arrow:!0,children:e.jsxs("span",{children:[a.title," ",a.number]})})}),e.jsx(s,{children:e.jsx(m,{title:t.indicators_of_success||"No Monitoring data added",arrow:!0,children:e.jsx("span",{children:t.indicators_of_success||"No Monitoring data added"})})}),e.jsx(s,{children:e.jsx(m,{title:t.monitoring_frequency||"No Frequency data added",arrow:!0,children:e.jsx("span",{children:t.monitoring_frequency||"No Frequency data added"})})}),e.jsx(s,{children:e.jsx(m,{title:t.compliance_rate?`${t.compliance_rate}% Compliance`:"No Compliance data",arrow:!0,children:e.jsx("span",{children:`${t.compliance_rate}%`})})}),e.jsx(s,{children:e.jsx(m,{title:t.challenges||"No Challenges data added",arrow:!0,children:e.jsx("span",{children:t.challenges||"No Challenges data added"})})}),e.jsx(s,{children:e.jsx(m,{title:t.violations_reports||"No Violations data added",arrow:!0,children:e.jsx("span",{children:t.violations_reports||"No Violations data added"})})}),e.jsx(s,{children:e.jsx(m,{title:t.feedback_mechanisms||"No Feedback data added",arrow:!0,children:e.jsx("span",{children:t.feedback_mechanisms||"No Feedback data added"})})}),e.jsx(s,{children:e.jsx(R,{variant:"outlined",onClick:()=>M(a,t),children:"Edit"})})]},`${a.id}-${t.id}`)):e.jsxs(L,{children:[e.jsx(s,{children:e.jsxs(m,{title:`${a.title} ${a.number}`,arrow:!0,placement:"top-start",children:[a.title," ",a.number]})}),e.jsx(s,{colSpan:6,children:"No Monitoring Data"}),e.jsx(s,{children:e.jsx(R,{variant:"contained",onClick:()=>M(a,null),children:"Add"})})]},a.id))})]})}),e.jsx(K,{sx:{display:"flex",justifyContent:"flex-end"},children:e.jsx(se,{rowsPerPageOptions:[10,20,100],component:"div",count:P.length,rowsPerPage:y,page:d,onPageChange:z,onRowsPerPageChange:N})}),e.jsxs(te,{open:W,onClose:()=>v(!1),children:[e.jsxs(ae,{children:[n!=null&&n.id?"Edit":"Add"," Monitoring Data"]}),e.jsxs(ne,{children:[e.jsx(j,{label:"Indicators of Success",name:"indicators_of_success",value:(n==null?void 0:n.indicators_of_success)||"",onChange:f,fullWidth:!0,margin:"normal"}),e.jsxs(j,{label:"Monitoring Frequency",name:"monitoring_frequency",select:!0,value:(n==null?void 0:n.monitoring_frequency)||"",onChange:f,fullWidth:!0,margin:"normal",children:[e.jsx(U,{value:"Monthly",children:"Monthly"}),e.jsx(U,{value:"Quarterly",children:"Quarterly"}),e.jsx(U,{value:"Yearly",children:"Yearly"})]}),e.jsx(j,{label:"Compliance Rate",name:"compliance_rate",type:"number",value:(n==null?void 0:n.compliance_rate)||"",onChange:a=>{const t=a.target.value;/^\d*\.?\d*$/.test(t)&&f(a)},inputProps:{step:"0.01",min:"0"},fullWidth:!0,margin:"normal"}),e.jsx(j,{label:"Challenges",name:"challenges",value:(n==null?void 0:n.challenges)||"",onChange:f,fullWidth:!0,margin:"normal"}),e.jsx(j,{label:"Violations",name:"violations_reports",value:(n==null?void 0:n.violations_reports)||"",onChange:f,fullWidth:!0,margin:"normal"}),e.jsx(j,{label:"Feedback Mechanisms",name:"feedback_mechanisms",value:(n==null?void 0:n.feedback_mechanisms)||"",onChange:f,fullWidth:!0,margin:"normal"})]}),e.jsxs(he,{children:[e.jsx(R,{onClick:()=>v(!1),children:"Cancel"}),e.jsx(R,{variant:"contained",onClick:B,children:"Save"})]})]}),e.jsx(de,{open:C.open,autoHideDuration:4e3,onClose:()=>p({open:!1,message:"",severity:"info"}),children:e.jsx(ue,{onClose:()=>p({open:!1,message:"",severity:"info"}),severity:C.severity,sx:{width:"100%"},children:C.message})})]})}function ua(){const[l,o]=i.useState([]),[h,w]=i.useState(""),[d,_]=i.useState(0),[y,F]=i.useState(10),[$,b]=i.useState(!0),[C,p]=i.useState({open:!1,message:"",severity:"info"}),[W,v]=i.useState(!1),[n,O]=i.useState(null);i.useEffect(()=>{var r;const a=localStorage.getItem("AssessmentRecords");if(a){const u=JSON.parse(a),x=Date.now()-u.cachedAt>1e3*60*5;if(((r=u.ordinances)==null?void 0:r.length)>0&&!x){o(u.ordinances),b(!1);return}}(async()=>{try{const u=await tt();u.length===0?p({open:!0,message:"No Record Found.",severity:"error"}):(p({open:!0,message:"Records fetched Successfully.",severity:"success"}),o(u))}catch{p({open:!0,message:"Error fetching Records.",severity:"error"})}finally{b(!1)}})()},[d,y]),i.useEffect(()=>{localStorage.setItem("AssessmentRecords",JSON.stringify({ordinances:l,cachedAt:Date.now()}))},[l]);const P=i.useMemo(()=>l.filter(a=>{var x,A,T;const t=h.toLowerCase(),r=((x=a.title)==null?void 0:x.toLowerCase().includes(t))||((A=a.number)==null?void 0:A.toString().toLowerCase().includes(t)),u=(T=a.impact_assessment)==null?void 0:T.some(E=>[].some(I=>E[I]&&E[I].toLowerCase().includes(t)));return r||u}),[l,h]),M=(a,t)=>{O({id:(t==null?void 0:t.id)||"",ordinance_id:a.id,funding_source:(t==null?void 0:t.funding_source)||"General Fund",outcomes_results:(t==null?void 0:t.outcomes_results)||"",gender_responsiveness_impact:(t==null?void 0:t.gender_responsiveness_impact)||"",community_benefits:(t==null?void 0:t.community_benefits)||"",adjustments_needed:(t==null?void 0:t.adjustments_needed)||"",feedback_mechanisms:(t==null?void 0:t.feedback_mechanisms)||""}),v(!0)},f=a=>{O({...n,[a.target.name]:a.target.value})},B=async()=>{try{n.id?(await qt(n.id,n),alert("Record updated successfully!")):(await Vt(n),alert("Record added successfully!")),v(!1),b(!0);const a=await tt(),t={ordinances:a,cachedAt:Date.now()};localStorage.setItem("AssessmentsRecords",JSON.stringify(t)),o(a),b(!1)}catch(a){p({open:!0,message:"Failed to save Record. Please try again.",severity:"error"}),console.error("Error saving Record:",a)}},k=a=>w(a.target.value),z=(a,t)=>_(t),N=a=>{F(parseInt(a.target.value,10)),_(0)};return $?e.jsx(je,{}):e.jsxs("div",{children:[e.jsx(j,{label:"Search Record",variant:"outlined",margin:"normal",value:h,onChange:k}),e.jsx(ie,{children:e.jsxs(oe,{children:[e.jsx(le,{children:e.jsxs(L,{children:[e.jsx(s,{children:"Title"}),e.jsx(s,{children:"Outcome Results"}),e.jsx(s,{children:"Gender Responsiveness Impact"}),e.jsx(s,{children:"Funding Source"}),e.jsx(s,{children:"Community Benefits"}),e.jsx(s,{children:"Adjustments Needed"}),e.jsx(s,{children:"Actions"})]})}),e.jsx(ce,{children:P.slice(d*y,d*y+y).flatMap(a=>a.impact_assessment.length>3?a.impact_assessment.map(t=>e.jsxs(L,{children:[e.jsx(s,{children:e.jsx(m,{title:`${a.title} ${a.number}`,arrow:!0,children:e.jsxs("span",{children:[a.title," ",a.number]})})}),e.jsx(s,{children:e.jsx(m,{title:t.outcomes_results,arrow:!0,children:e.jsx("span",{children:t.outcomes_results})})}),e.jsx(s,{children:e.jsx(m,{title:t.gender_responsiveness_impact,arrow:!0,children:e.jsx("span",{children:t.gender_responsiveness_impact})})}),e.jsx(s,{children:e.jsx(m,{title:t.funding_source,arrow:!0,children:e.jsx("span",{children:t.funding_source&&`${t.funding_source}`})})}),e.jsx(s,{children:e.jsx(m,{title:t.community_benefits,arrow:!0,children:e.jsx("span",{children:t.community_benefits})})}),e.jsx(s,{children:e.jsx(m,{title:t.adjustments_needed,arrow:!0,children:e.jsx("span",{children:t.adjustments_needed})})}),e.jsx(s,{children:e.jsx(R,{variant:"outlined",onClick:()=>M(a,t),children:"Edit"})})]},`${a.id}-${t.id}`)):e.jsxs(L,{children:[e.jsx(s,{children:e.jsx(m,{title:`${a.title} ${a.number}`,arrow:!0,placement:"top-start",children:e.jsxs("span",{children:[a.title," ",a.number]})})}),e.jsx(s,{colSpan:5,children:"No Assessment Data"}),e.jsx(s,{children:e.jsx(R,{variant:"contained",onClick:()=>M(a,null),children:"Add"})})]},a.id))})]})}),e.jsx(K,{sx:{display:"flex",justifyContent:"flex-end"},children:e.jsx(se,{rowsPerPageOptions:[10,20,100],component:"div",count:P.length,rowsPerPage:y,page:d,onPageChange:z,onRowsPerPageChange:N})}),e.jsxs(te,{open:W,onClose:()=>v(!1),children:[e.jsxs(ae,{children:[n!=null&&n.id?"Edit":"Add"," Monitoring Data"]}),e.jsxs(ne,{children:[e.jsx(j,{label:"Outcome Results",name:"outcomes_results",value:(n==null?void 0:n.outcomes_results)||"",onChange:f,fullWidth:!0,margin:"normal"}),e.jsxs(j,{label:"Funding Source",name:"funding_source",select:!0,onChange:f,value:(n==null?void 0:n.funding_source)||"",fullWidth:!0,margin:"normal",children:[e.jsx(U,{value:"General Fund",children:"General Fund"}),e.jsx(U,{value:"Grants",children:"Grants"}),e.jsx(U,{value:"Others",children:"Others"})]}),e.jsx(j,{label:"Gender Responsiveness Impact",name:"gender_responsiveness_impact",value:(n==null?void 0:n.gender_responsiveness_impact)||"",onChange:f,fullWidth:!0,margin:"normal"}),e.jsx(j,{label:"Community Benefits",name:"community_benefits",value:(n==null?void 0:n.community_benefits)||"",onChange:f,fullWidth:!0,margin:"normal"}),e.jsx(j,{label:"Adjustments Needed",name:"adjustments_needed",value:(n==null?void 0:n.adjustments_needed)||"",onChange:f,fullWidth:!0,margin:"normal"}),e.jsx(j,{label:"Feedback Mechanisms",name:"feedback_mechanisms",value:(n==null?void 0:n.feedback_mechanisms)||"",onChange:f,fullWidth:!0,margin:"normal"})]}),e.jsxs(he,{children:[e.jsx(R,{onClick:()=>v(!1),children:"Cancel"}),e.jsx(R,{variant:"contained",onClick:B,children:"Save"})]})]}),e.jsx(de,{open:C.open,autoHideDuration:4e3,onClose:()=>p({open:!1,message:"",severity:"info"}),children:e.jsx(ue,{onClose:()=>p({open:!1,message:"",severity:"info"}),severity:C.severity,sx:{width:"100%"},children:C.message})})]})}function va(){const[l,o]=i.useState(0),h=(w,d)=>{o(d)};return e.jsxs(Jt,{children:[e.jsxs(Yt,{value:l,onChange:h,children:[e.jsx(re,{label:"Records Table"}),e.jsx(re,{label:"Coverage Table"}),e.jsx(re,{label:"Objectives Table"}),e.jsx(re,{label:"Budget Table"}),e.jsx(re,{label:"Records Monitoring Table"}),e.jsx(re,{label:"Impact Assessment Table"})]}),e.jsxs("div",{style:{marginTop:"30px"},children:[l===0&&e.jsx(ia,{formType:"A"}),l===1&&e.jsx(oa,{formType:"B"}),l===2&&e.jsx(la,{formType:"C"}),l===3&&e.jsx(ca,{formType:"D"}),l===4&&e.jsx(da,{formType:"E"}),l===5&&e.jsx(ua,{formType:"F"})]})]})}export{va as default};
