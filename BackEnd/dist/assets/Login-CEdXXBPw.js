import{j as e,ap as k,aq as W,a as r,K as i,J as o,Z as u,ar as E}from"./index-C8JWgRoo.js";import{T as m}from"./TextField-BohWtvo1.js";import{D,a as P,b as A}from"./DialogTitle-B9vAwaz6.js";import{D as B}from"./DialogActions-DYjaLRLY.js";const p=({path:n,fill:l,duration:s,height:d})=>e.jsx(k.div,{animate:{x:["0%","-30%","0"],y:["0%","10%","0%"]},transition:{duration:s,repeat:1/0,ease:"linear"},style:{display:"flex",width:"500%",position:"absolute",bottom:0,height:d,overflow:"hidden",zIndex:2},children:[...Array(2)].map((c,h)=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1440 320",preserveAspectRatio:"none",style:{width:"100%",height:"100%"},children:e.jsx("path",{fill:l,d:n})},h))}),I=()=>e.jsxs("div",{style:{position:"absolute",bottom:0,width:"100%",height:"300%"},children:[e.jsx(p,{height:"360px",duration:30,fill:"#ffffff22",path:"M0,64L48,101.3C96,139,192,213,288,240C384,267,480,245,576,208C672,171,768,117,864,117.3C960,117,1056,171,1152,181.3C1248,192,1344,160,1392,144L1440,128V320H0Z"}),e.jsx(p,{height:"180px",duration:20,fill:"#ffffff44",path:"M0,96L60,128C120,160,240,224,360,229.3C480,235,600,181,720,160C840,139,960,149,1080,170.7C1200,192,1320,224,1380,240L1440,256V320H0Z"}),e.jsx(p,{height:"400px",duration:12,fill:"#ffffff66",path:"M0,128L80,160C160,192,320,256,480,256C640,256,800,192,960,165.3C1120,139,1280,149,1360,154.7L1440,160V320H0Z"})]}),O=({setIsLoggedIn:n})=>{const l=W(),[s,d]=r.useState(""),[c,h]=r.useState(""),[f,j]=r.useState(""),[C,g]=r.useState(!1),[b,F]=r.useState(""),[v,y]=r.useState(""),[w,x]=r.useState(""),L=async t=>{t.preventDefault(),j("");try{await E({username:s,password:c}),sessionStorage.setItem("isLoggedIn","true"),n(!0),l("/dashboard"),setTimeout(()=>window.location.reload(),100)}catch(a){j(a||"Login failed")}},S=async()=>{x(""),y("");try{const t=await fetch("/api/forgot-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:b})}),a=await t.json();t.ok?y(a.message||"Reset link sent."):x(a.error||"Something went wrong.")}catch{x("Network error. Try again later.")}};return e.jsxs(i,{sx:{height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",p:2,position:"relative",overflow:"hidden"},children:[e.jsxs(i,{sx:{display:{xs:"none",md:"block"},position:"absolute",top:"5%",left:"5%",color:"white",zIndex:0},children:[e.jsx(o,{variant:"h2",color:"#FF7704",fontWeight:600,children:"Welcome to Cauayan Cares"}),e.jsx(o,{variant:"h4",fontWeight:600,children:"Archiving System: Preserving Records, Empowering Communities"})]}),e.jsx(I,{}),e.jsx(i,{sx:{display:{xs:"none",md:"block"},position:"absolute",bottom:"10%",left:"5%",zIndex:0},children:e.jsx("img",{src:"/LoginPoster.svg",alt:"Login Poster",style:{maxWidth:"100%",height:"auto"}})}),e.jsxs(i,{sx:{backdropFilter:"blur(10px)",WebkitBackdropFilter:"blur(10px)",backgroundColor:"rgba(255, 255, 255, 0.28)",p:4,zIndex:3,borderRadius:"10px",width:{xs:"90%",sm:"60%",md:"30%"},minWidth:"300px",boxShadow:3,position:{xs:"relative",md:"absolute"},right:{md:"10%"}},children:[e.jsx(o,{variant:"h5",fontWeight:"bold",color:"#FF7706",gutterBottom:!0,children:"Login"}),e.jsx(o,{color:"textSecondary",mb:2,sx:{color:"white"},children:"Please enter your login credentials"}),f&&e.jsx(o,{color:"error",mb:2,children:f}),e.jsxs("form",{onSubmit:L,children:[e.jsx(m,{fullWidth:!0,type:"text",label:"Username",value:s,onChange:t=>d(t.target.value),required:!0,variant:"outlined",margin:"normal"}),e.jsx(m,{fullWidth:!0,type:"password",label:"Password",value:c,onChange:t=>h(t.target.value),required:!0,variant:"outlined",margin:"normal"}),e.jsx(u,{type:"submit",variant:"contained",fullWidth:!0,sx:{mt:2,bgcolor:"#5D378C",color:"#fff",":hover":{bgcolor:"#4B2A6F"}},children:"Login"})]}),e.jsx(o,{variant:"body2",sx:{mt:2,textAlign:"center",cursor:"pointer",color:"#5D378C"},onClick:()=>g(!0),children:"Forgot your password?"})]}),e.jsxs(D,{open:C,onClose:()=>g(!1),children:[e.jsx(P,{children:"Forgot Password"}),e.jsxs(A,{children:[e.jsx(o,{mb:2,children:"Enter your registered email address to receive a password reset link."}),w&&e.jsx(o,{color:"error",mb:2,children:w}),v&&e.jsx(o,{color:"primary",mb:2,children:v}),e.jsx(m,{autoFocus:!0,margin:"dense",label:"Email Address",type:"email",fullWidth:!0,variant:"outlined",value:b,onChange:t=>F(t.target.value)})]}),e.jsxs(B,{children:[e.jsx(u,{onClick:()=>g(!1),children:"Cancel"}),e.jsx(u,{variant:"contained",sx:{bgcolor:"#5D378C",":hover":{bgcolor:"#4B2A6F"}},onClick:S,children:"Send Reset Link"})]})]})]})};export{O as default};
